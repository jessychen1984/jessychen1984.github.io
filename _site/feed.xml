<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://kiwijia.work/feed.xml" rel="self" type="application/atom+xml" /><link href="https://kiwijia.work/" rel="alternate" type="text/html" /><updated>2020-04-24T18:58:37+08:00</updated><id>https://kiwijia.work/feed.xml</id><title type="html">KiwiJia Blog</title><subtitle>This is KiwiJia's blog</subtitle><entry><title type="html">ä¸»å®šç†åˆ†æç®—æ³•çš„æ—¶é—´å¤æ‚åº¦</title><link href="https://kiwijia.work/2020/04/25/master-theorem/" rel="alternate" type="text/html" title="ä¸»å®šç†åˆ†æç®—æ³•çš„æ—¶é—´å¤æ‚åº¦" /><published>2020-04-25T00:00:00+08:00</published><updated>2020-04-25T00:00:00+08:00</updated><id>https://kiwijia.work/2020/04/25/master-theorem</id><content type="html" xml:base="https://kiwijia.work/2020/04/25/master-theorem/">&lt;blockquote&gt;
  &lt;p&gt;åœ¨&lt;a href=&quot;https://zh.wikipedia.org/wiki/ç®—æ³•åˆ†æ&quot;&gt;æ¼”ç®—æ³•åˆ†æ&lt;/a&gt;ä¸­ï¼Œ&lt;strong&gt;æ”¯é…ç†è®º&lt;/strong&gt;ï¼ˆè‹±èªï¼šmaster theoremï¼‰æä¾›äº†ç”¨æ¸è¿‘ç¬¦å·ï¼ˆ&lt;a href=&quot;https://zh.wikipedia.org/wiki/å¤§Oç¬¦å·&quot;&gt;å¤§Oç¬¦å·&lt;/a&gt;ï¼‰è¡¨ç¤ºè®¸å¤šç”±&lt;a href=&quot;https://zh.wikipedia.org/wiki/åˆ†æ²»æ³•&quot;&gt;åˆ†æ²»æ³•&lt;/a&gt;å¾—åˆ°çš„&lt;a href=&quot;https://zh.wikipedia.org/wiki/é€’æ¨å…³ç³»å¼&quot;&gt;é€’æ¨å…³ç³»å¼&lt;/a&gt;çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•æœ€åˆç”±&lt;a href=&quot;https://en.wikipedia.org/wiki/Jon_Bentley_(computer_scientist)&quot;&gt;Jon Bentlery&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://en.wikipedia.org/wiki/Dorothea_Haken&quot;&gt;Dorothea Haken&lt;/a&gt;å’Œ&lt;a href=&quot;https://en.wikipedia.org/wiki/James_B._Saxe&quot;&gt;James B. Saxe&lt;/a&gt;åœ¨1980å¹´æå‡ºï¼Œåœ¨é‚£é‡Œè¢«æè¿°ä¸ºè§£å†³è¿™ç§é€’æ¨çš„â€œå¤©ä¸‹ç„¡æ•µæ³•â€(master method)ã€‚æ­¤æ–¹æ³•ç»ç”±ç»å…¸æ¼”ç®—æ³•æ•™ç§‘ä¹¦&lt;a href=&quot;https://en.wikipedia.org/wiki/Thomas_H._Cormen&quot;&gt;Cormen&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://en.wikipedia.org/wiki/Charles_E._Leiserson&quot;&gt;Leiserson&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://en.wikipedia.org/wiki/Ron_Rivest&quot;&gt;Rivest&lt;/a&gt;å’Œ&lt;a href=&quot;https://en.wikipedia.org/wiki/Clifford_Stein&quot;&gt;Stein&lt;/a&gt;çš„ã€Š&lt;a href=&quot;https://zh.wikipedia.org/wiki/ç®—æ³•å¯¼è®º&quot;&gt;æ¼”ç®—æ³•å¯¼è®º&lt;/a&gt;ã€‹ (introduction to algorithm) æ¨å¹¿è€Œä¸ºäººç†ŸçŸ¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼Œé€’å½’æ˜¯ç®—æ³•çš„ä¸€ä¸ªé‡è¦è¡¨ç°å½¢å¼ï¼Œä¸ä»…ä½œç”¨å¤§ï¼Œè€Œä¸”å…¶å¤æ‚åº¦çš„åˆ†æä¹Ÿæ¯”å…¶ä»–æ–¹å¼è¦ç¹æ‚ã€‚æ€æ ·æœ‰æ•ˆçš„ç¡®å®šæ™®é€šé€’å½’å¼å’Œä¸€äº›å…¸å‹ç®—æ³•é€’å½’å¼çš„å¤æ‚åº¦ï¼Œæ˜¯é¢è¯•ä¸­å¸¸å¸¸ä¼šè¢«é—®åˆ°çš„ã€‚ç”±äºé€’å½’å¼å¤æ‚åº¦çš„éš¾ä»¥ç¡®å®šï¼Œæ‰€ä»¥ç›®å‰å¸¸ç”¨çš„æ–¹æ³•æœ‰è¿™ä¹ˆå‡ ç§ï¼š&lt;strong&gt;ä»£æ¢çŒœæµ‹æ³•ã€é€’å½’æ ‘æ³•ã€ä¸»å®šç†ã€ç›´æ¥æ•°å­¦åˆ†ææ³•&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ä»£æ¢çŒœæµ‹æ³•é€šå¸¸å’Œé€’å½’æ ‘æ³•åˆç”¨ï¼Œåˆ©ç”¨é€’å½’æ ‘æ³•å¾—åˆ°ä¸€ä¸ªå¤§æ¦‚æ­£ç¡®çš„ç»“æœï¼Œç„¶ååˆ©ç”¨æ•°å­¦å½’çº³æ³•å¯¹å…¶éªŒè¯ã€‚&lt;/p&gt;

&lt;p&gt;ç›´æ¥çš„æ•°å­¦åˆ†ææ³•ç›¸å¯¹å¾ˆç›´æ¥ï¼Œå¾ˆå¼ºå¤§ï¼Œä½†æ˜¯å¯¹æ•°å­¦è¦æ±‚å¾ˆé«˜ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ç®—æ³•åˆ†æä¸­ï¼Œä¸»å®šç†ï¼ˆmaster theoremï¼‰æä¾›äº†ç”¨æ¸è¿‘ç¬¦å·è¡¨ç¤ºè®¸å¤šç”±åˆ†æ²»æ³•å¾—åˆ°çš„é€’æ¨å…³ç³»å¼çš„æ–¹æ³•ã€‚ä¸»å®šç†é€šå¸¸å¯ä»¥è§£å†³å¦‚ä¸‹çš„é€’å½’è¡¨è¾¾å¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;T(n)=a*Tï¼ˆn/bï¼‰+fï¼ˆnï¼‰&lt;/strong&gt;&lt;/p&gt;

&lt;h3 id=&quot;ä¸»å®šç†&quot;&gt;ä¸»å®šç†&lt;/h3&gt;

&lt;p&gt;é¦–å…ˆï¼Œæ˜¯ç¬¦å·çš„è§£é‡Šï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ç¬¦å·Î˜ï¼Œè¯»éŸ³è¥¿å¡”ï¼Œæ—¢æ˜¯ä¸Šç•Œä¹Ÿæ˜¯ä¸‹ç•Œï¼Œç­‰äºï¼Œä¸¥æ ¼è´´ç´§ã€‚&lt;/li&gt;
  &lt;li&gt;ç¬¦å·ğ‘‚ï¼Œè¯»éŸ³æ®´ï¼Œè¡¨ç¤ºä¸Šç•Œï¼Œå°äºç­‰äºï¼Œè´´ç´§æœªçŸ¥ã€‚&lt;/li&gt;
  &lt;li&gt;ç¬¦å·ğ‘œï¼Œè¯»éŸ³ä¹Ÿæ˜¯æ®´ï¼Œå°äºï¼Œä¸è´´ç´§ã€‚&lt;/li&gt;
  &lt;li&gt;ç¬¦å·Î©ï¼Œè¯»éŸ³å¶çœ¯å˜ï¼Œè¡¨ç¤ºä¸‹ç•Œï¼Œå¤§äºç­‰äºï¼Œè´´ç´§æœªçŸ¥ã€‚&lt;/li&gt;
  &lt;li&gt;ç¬¦å·ğœ”ï¼Œè¯»éŸ³ä¹Ÿæ˜¯å¶çœ¯å˜ï¼Œè¡¨ç¤ºä¸‹ç•Œï¼Œå¤§äºï¼Œä¸è´´ç´§ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¸Šé¢çš„â€œè´´ç´§â€æ˜¯tightç¿»è¯‘è¿‡æ¥çš„ï¼Œå¤§æ¦‚å°±æ˜¯æ˜¯å¦ä¸¥æ ¼ç­‰äºçš„æ„æ€å§ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æ„æ€å°±æ˜¯Î˜æ˜¯å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼Œğ‘‚æ˜¯æœ€åæƒ…å†µä¸‹çš„å¤æ‚åº¦ï¼ŒÎ©æ˜¯æœ€å¥½æƒ…å†µä¸‹çš„å¤æ‚åº¦ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ä¸‹é¢æ˜¯ä¸»å®šç†ï¼Œæ¥æº&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E4%B8%BB%E5%AE%9A%E7%90%86&quot;&gt;ç»´åŸºç™¾ç§‘&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/algorithm/2.png&quot; alt=&quot;image-20200424150950868&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;å¸¸è§åº”ç”¨&quot;&gt;å¸¸è§åº”ç”¨&lt;/h3&gt;

&lt;p&gt;å¯¹äºåº”ç”¨ä¸»å®šç†æ¥è¯´ï¼Œä¸€å®šè¦åˆ†æ¸…é€‰å–å®šå®šç†ä¸­çš„å“ªç§æƒ…å†µï¼ˆå¦‚æœæœ‰ç¬¦åˆçš„ï¼‰ã€‚ä¸‹é¢æ˜¯å¸¸è§çš„å‡ ç§åº”ç”¨ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/algorithm/1.png&quot; alt=&quot;image-20200424151826459&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å¯¹äºå¤æ‚çš„é€’å½’ï¼Œå¯ä»¥å…ˆæ‰¾å‡†é€’å½’å…³ç³»å¼ï¼Œå†ç”¨ä¸Šé¢ä¸‰ç§æƒ…å†µå¸¦å…¥æ¥è®¡ç®—æ—¶é—´å¤æ‚åº¦ã€‚å¯¹äºä¸€èˆ¬çš„é¢è¯•å·²ç»è¶³å¤Ÿç”¨äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;em&gt;æœ¬æ–‡å†…å®¹æ•´ç†äºç½‘ç»œ&lt;/em&gt;&lt;/p&gt;</content><author><name>jessychen</name></author><category term="algorithm" /><category term="CS" /><summary type="html">åœ¨æ¼”ç®—æ³•åˆ†æä¸­ï¼Œæ”¯é…ç†è®ºï¼ˆè‹±èªï¼šmaster theoremï¼‰æä¾›äº†ç”¨æ¸è¿‘ç¬¦å·ï¼ˆå¤§Oç¬¦å·ï¼‰è¡¨ç¤ºè®¸å¤šç”±åˆ†æ²»æ³•å¾—åˆ°çš„é€’æ¨å…³ç³»å¼çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•æœ€åˆç”±Jon Bentleryï¼ŒDorothea Hakenå’ŒJames B. Saxeåœ¨1980å¹´æå‡ºï¼Œåœ¨é‚£é‡Œè¢«æè¿°ä¸ºè§£å†³è¿™ç§é€’æ¨çš„â€œå¤©ä¸‹ç„¡æ•µæ³•â€(master method)ã€‚æ­¤æ–¹æ³•ç»ç”±ç»å…¸æ¼”ç®—æ³•æ•™ç§‘ä¹¦Cormenï¼ŒLeisersonï¼ŒRivestå’ŒSteinçš„ã€Šæ¼”ç®—æ³•å¯¼è®ºã€‹ (introduction to algorithm) æ¨å¹¿è€Œä¸ºäººç†ŸçŸ¥ã€‚</summary></entry><entry><title type="html">Airflowä¸­è‡ªå®šä¹‰æŠ¥è­¦æœºåˆ¶åŠå¯¹Slackå’ŒOpsgenieé›†æˆ</title><link href="https://kiwijia.work/2020/04/17/alert/" rel="alternate" type="text/html" title="Airflowä¸­è‡ªå®šä¹‰æŠ¥è­¦æœºåˆ¶åŠå¯¹Slackå’ŒOpsgenieé›†æˆ" /><published>2020-04-17T00:00:00+08:00</published><updated>2020-04-17T00:00:00+08:00</updated><id>https://kiwijia.work/2020/04/17/alert</id><content type="html" xml:base="https://kiwijia.work/2020/04/17/alert/">&lt;p&gt;æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œç”¨Ariflowåšä»»åŠ¡è°ƒåº¦æ˜¯ååˆ†æ–¹ä¾¿çš„ã€‚ç„¶è€Œï¼Œä»»ä½•ç¨‹åºéƒ½å…ä¸äº†é¢ä¸´æ‰§è¡Œå¤±è´¥çš„é—®é¢˜ã€‚è™½ç„¶æœ‰retryå¤§æ³•ï¼Œä½†å½“retryä¹Ÿå¤±è´¥çš„è¯ï¼Œè¿˜æ˜¯éœ€è¦äººå·¥å¹²é¢„ã€‚è¿™æ—¶å€™ï¼ŒåŠæ—¶è€Œå…¨é¢çš„æŠ¥è­¦å°±æ˜¾å¾—ç›¸å½“é‡è¦ã€‚ä»Šå¤©ï¼Œå°±æ¥ä»‹ç»ä¸‹Airflowä¸­çš„æŠ¥è­¦æœºåˆ¶ã€‚åŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;#è‡ªå¸¦emailé€šçŸ¥&quot;&gt;è‡ªå¸¦Emailé€šçŸ¥&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#è‡ªå®šä¹‰email&quot;&gt;è‡ªå®šä¹‰Email&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#æ¶ˆæ¯å‘é€è‡³slack&quot;&gt;æ¶ˆæ¯å‘é€è‡³Slack&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ä¸opsgenieé›†æˆè·å–oncaller&quot;&gt;ä¸Opsgenieé›†æˆè·å–oncaller&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;è‡ªå¸¦emailé€šçŸ¥&quot;&gt;è‡ªå¸¦Emailé€šçŸ¥&lt;/h3&gt;

&lt;p&gt;ç›¸ä¿¡å¤§å¤šæ•°ç”¨è¿‡airflowçš„äººå¯¹å…¶è‡ªå¸¦çš„email alertåŠŸèƒ½ä¸ä¼šé™Œç”Ÿã€‚åªè¦ä¸€äº›ç®€å•çš„confå’Œcodeæ·»åŠ ï¼Œå°±å¯ä»¥å®ç°DAGå¤±è´¥æ—¶å‘é€é‚®ä»¶è‡³æŒ‡å®šé‚®ç®±ã€‚éœ€è¦ä¸¤æ­¥ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;æ·»åŠ smtpé…ç½®ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œconfæ–‡ä»¶å’Œç¯å¢ƒå˜é‡ï¼ˆenv varï¼‰ï¼Œè§: &lt;a href=&quot;https://airflow.readthedocs.io/en/stable/howto/set-config.html&quot;&gt;airflow config&lt;/a&gt;ã€‚å¦‚æœä¸¤ä¸ªåœ°æ–¹éƒ½é…ç½®äº†çš„è¯ï¼Œç¯å¢ƒå˜é‡çš„çš„ä¼˜å…ˆçº§ä¼šé«˜äºconfä¸­çš„é…ç½®ã€‚&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;åœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;airflow.cfg&lt;/code&gt;ä¸­æ·»åŠ smtpé…ç½®ï¼š&lt;/li&gt;
    &lt;/ul&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;email]
email_backend &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; airflow.utils.email.send_email_smtp
   
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;smtp]
&lt;span class=&quot;c&quot;&gt;# If you want airflow to send emails on retries, failure, and you want to use&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# the airflow.utils.email.send_email_smtp function, you have to configure an&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# smtp server here&lt;/span&gt;
smtp_host &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; localhost
smtp_starttls &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; True
smtp_ssl &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; False
&lt;span class=&quot;c&quot;&gt;# Uncomment and set the user/pass settings if you want to use SMTP AUTH&lt;/span&gt;
smtp_user &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; airflow
smtp_password &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; airflow
smtp_port &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 25
smtp_mail_from &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; airflow@example.com
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;ul&gt;
      &lt;li&gt;åœ¨ç¯å¢ƒå˜é‡ï¼ˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;env var&lt;/code&gt;ï¼‰ä¸­æ·»åŠ ï¼Œæ ¼å¼ä¸º&lt;code class=&quot;highlighter-rouge&quot;&gt;$AIRFLOW__{SECTION}__{KEY}&lt;/code&gt;ï¼ˆæ³¨æ„ä¸­é—´æ˜¯ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰ã€‚ç±»ä¼¼ï¼š&lt;/li&gt;
    &lt;/ul&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;AIRFLOW__SMTP__SMTP_HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;smtp.example.com
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;å®Œæˆsmtpé…ç½®åï¼Œå¯ä»¥åœ¨UIç•Œé¢çš„&lt;strong&gt;Admin-&amp;gt;Configuration&lt;/strong&gt;ä¸­æŸ¥åˆ°ï¼š&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/img/in-post/Airflow/config.png&quot; alt=&quot;image-20200416162741711&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;åœ¨DAGçš„&lt;code class=&quot;highlighter-rouge&quot;&gt;default_args&lt;/code&gt;ä¸­é…ç½®DAG run failedæ—¶å‘é€æŠ¥è­¦ï¼š&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;'email'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;airflow@example.com&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;'email_on_failure'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;'email_on_retry'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
   
&lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DAG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;dag_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;default_args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨DAGæ‰§è¡Œå¤±è´¥æ˜¯æ”¶åˆ°æŠ¥è­¦é‚®ä»¶äº†ï¼Œé‚®ä»¶å†…å®¹ç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-reStructuredText&quot;&gt;title: Airflow alert: &amp;lt;TaskInstance: dag_id.task_id 2020-04-02T03:59:29.527624+00:00 [failed]&amp;gt;
----
content:
Try 4 out of 1
Exception:
The conn_id `***` isn't defined
Log: Link
Host: airflow-worker-0.airflow-worker.airflow.svc.cluster.local
Log file: /usr/local/airflow/logs/airflow-worker-0/dag_id/task_id/2020-04-02T03:59:29.527624+00:00.log
Mark success: Link
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;è‡ªå®šä¹‰email&quot;&gt;è‡ªå®šä¹‰Email&lt;/h3&gt;

&lt;p&gt;ç„¶è€Œï¼Œè‡ªå¸¦çš„é‚®ä»¶æŠ¥è­¦æœ‰ä¸€äº›å±€é™æ€§ï¼Œå½“ä¸šåŠ¡å¢å¤šå˜å¾—å¤æ‚æ—¶ä¼šä¸èƒ½æ»¡è¶³æˆ‘ä»¬å®šåˆ¶åŒ–çš„éœ€æ±‚ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ä¸èƒ½è‡ªå®šä¹‰titleï¼›&lt;/li&gt;
  &lt;li&gt;é‚®ä»¶å†…å®¹ç›¸å¯¹ç®€å•ï¼Œåªæœ‰å‡ºé”™çš„exception message ä¿¡æ¯ï¼›&lt;/li&gt;
  &lt;li&gt;æ”¶ä»¶äººåªèƒ½é…ç½®ä¸€æ¬¡ï¼Œæ‰€æœ‰DAGçš„æŠ¥è­¦ä¼šå‘ç»™åŒæ ·çš„é‚®ç®±ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…¶å®ï¼Œåœ¨Airflowä¸­å‘é€è‡ªå®šä¹‰çš„Emailä¹Ÿååˆ†æ–¹ä¾¿ã€‚Airflowè‡ªå¸¦äº†ä¸€ä¸ªemailæ¨¡å—ï¼Œåªè¦è°ƒç”¨é‡Œé¢çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;send_email&lt;/code&gt;æ–¹æ³•ï¼Œä¼ å…¥è‡ªå®šä¹‰çš„æ”¶ä»¶äººï¼Œæ ‡é¢˜ï¼Œå†…å®¹ï¼Œé™„ä»¶ï¼Œå°±å¯ä»¥å®ç°é‚®ä»¶çš„å®šåˆ¶åŒ–ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;airflow.utils.email&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;send_email&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mail_to&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;airflow@example.com&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;subject&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;This is alert email title&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;This is alert email content&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;attachments&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;attach1.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;attach2.txt&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;send_email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mail_to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attachments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é‚£ä¹ˆï¼Œæˆ‘ä»¬åœ¨å“ªé‡Œè°ƒç”¨è¿™ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;send_email&lt;/code&gt;å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä¿®æ”¹DAGçš„default_argså‚æ•°ï¼Œå®šä¹‰DAGå¤±è´¥æ˜¯çš„callbackå‡½æ•°ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;'on_failure_callback'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;task_fail_alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;task_fail_alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;send_email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mail_to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attachments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é™¤äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;send_email&lt;/code&gt;ï¼ŒAirflowè¿˜æä¾›äº†ä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;send_email_smtp&lt;/code&gt;æ–¹æ³•ï¼ŒåŒæ ·å¯ä»¥å‘é‚®ä»¶ã€‚ä¸¤è€…çš„è¾“å…¥å‚æ•°æ˜¯ä¸€æ ·çš„ã€‚é‚£æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹æºç ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;send_email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html_content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;files&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dryrun&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bcc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;mime_subtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'mixed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mime_charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
    Send email using backend specified in EMAIL_BACKEND.
    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'email'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'EMAIL_BACKEND'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsplit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;importlib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;import_module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;backend&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_email_address_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;, &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;backend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html_content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;files&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                   &lt;span class=&quot;n&quot;&gt;dryrun&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dryrun&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bcc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bcc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                   &lt;span class=&quot;n&quot;&gt;mime_subtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mime_subtype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mime_charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mime_charset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;send_email_smtp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html_content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;files&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;dryrun&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bcc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;mime_subtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'mixed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mime_charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
    Send an email with html content
    &amp;gt;&amp;gt;&amp;gt; send_email('test@example.com', 'foo', '&amp;lt;b&amp;gt;Foo&amp;lt;/b&amp;gt; bar', ['/dev/null'], dryrun=True)
    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;smtp_mail_from&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'smtp'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'SMTP_MAIL_FROM'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_email_address_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MIMEMultipart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mime_subtype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Subject'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subject&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'From'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smtp_mail_from&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'To'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;, &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;recipients&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#more code be omitted.
&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä»æºç å¯ä»¥çœ‹å‡ºï¼Œsend_emailè°ƒç”¨äº†Airflow confé‡Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;email_backend&lt;/code&gt;ä¸­æŒ‡å®šçš„å‘é‚®ä»¶æ–¹æ³•ï¼Œä¸€èˆ¬ä¸æ”¹çš„è¯é»˜è®¤å€¼æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;airflow.utils.email.send_email_smtp&lt;/code&gt;ã€‚æ‰€ä»¥é»˜è®¤é…ç½®ä¸­ä¸¤è€…æ˜¯ç­‰ä»·çš„ã€‚å¦‚æœè§‰å¾—è‡ªå¸¦çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;send_email_smpt&lt;/code&gt;æ–¹æ³•ä¸èƒ½æ»¡è¶³éœ€æ±‚çš„è¯ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰é‚®ä»¶å‘é€æ–¹æ³•ï¼Œåœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;email_backend&lt;/code&gt;ä¸­æŒ‡å®šå°±å¯ä»¥äº†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;æ¶ˆæ¯å‘é€è‡³slack&quot;&gt;æ¶ˆæ¯å‘é€è‡³Slack&lt;/h3&gt;

&lt;p&gt;ä¸è¿‡ï¼Œå¯¹äºé‚®ç®±ä¸­çš„é‚®ä»¶ï¼Œæˆ‘ä»¬å…¶å®ç»å¸¸ä¸èƒ½åŠæ—¶çœ‹åˆ°ã€‚æ‰€ä»¥å¯¹äºé‡è¦æŠ¥è­¦ï¼Œæ›´å¥½çš„æ–¹å¼æ˜¯èƒ½å‘åˆ°å³æ—¶é€šä¿¡è½¯ä»¶ï¼ˆä¾‹å¦‚Slackï¼‰ä¸­ï¼Œæ–¹ä¾¿æˆ‘ä»¬ç«‹åˆ»æ”¶åˆ°å¤„ç†ã€‚&lt;strong&gt;Slack&lt;/strong&gt;æ˜¯ç±»ä¼¼äºé’‰é’‰ã€RTXçš„ä¸€æ¬¾ä¼˜ç§€çš„ä¼ä¸šé€šä¿¡å·¥å…·ã€‚è¿™é‡Œä»¥Slackä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•é€šè¿‡SlackåŠæ—¶æ¥æ”¶DAGå¤±è´¥çš„æ¶ˆæ¯ã€‚å½“ç„¶ï¼Œæ ¹æ®éœ€è¦ï¼Œä¹Ÿå¯ä»¥æ¢æˆå…¶ä»–çš„å³æ—¶é€šä¿¡å·¥å…·ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬çŸ¥é“ï¼ŒAirflowè´¡çŒ®çš„Operatoræ˜¯ååˆ†ä¸°å¯Œçš„ã€‚å…¶ä¸­ï¼Œä¹Ÿæœ‰ç”¨äºSlackçš„operatorå¯ä»¥é€‰æ‹©ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;SlackWebhookOperator&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;SlackAPIOperator&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;SlackAPIPostOperator&lt;/code&gt;ã€‚æ˜¯ä¸æ˜¯æœ‰ç‚¹å¤šï¼Ÿå…ˆè§£é‡Šä¸‹å®ƒä»¬çš„åŒºåˆ«å§ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ç›®å‰ä¸ºæ­¢æœ€æ–°çš„releaseç‰ˆæœ¬ï¼ˆv1-10ï¼‰codeä¸­ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SlackWebhookOperator&lt;/code&gt; ä½äº&lt;em&gt;airflow/contrib/operators/slack_webhook_operator.py&lt;/em&gt;ï¼Œç»§æ‰¿äº&lt;code class=&quot;highlighter-rouge&quot;&gt;SimpleHttpOperator&lt;/code&gt;ã€‚ä»ä½ç½®å¯çœ‹å‡ºè¿™æ˜¯ç”±ç¬¬ä¸‰æ–¹è´¡çŒ®çš„ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;SlackAPIOperator&lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;SlackAPIPostOperator&lt;/code&gt;ä½äº&lt;em&gt;airflow/operators/slack_operator.py&lt;/em&gt;ï¼Œå‰è€…ç»§æ‰¿äº&lt;code class=&quot;highlighter-rouge&quot;&gt;BaseOperator&lt;/code&gt;ï¼Œåè€…ç»§æ‰¿ä¸å‰è€…ã€‚ä»ä½ç½®å¯çœ‹å‡ºè¿™ä¸ªæ˜¯airflowå›¢é˜Ÿå†™çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¸Šé¢ä¸¤ç±»operatorçš„åŠŸèƒ½æ˜¯é‡å¤çš„ï¼Œæˆ‘ä»¬ä»»é€‰ä¸€ç§æ¥ç”¨å°±å¯ä»¥äº†ã€‚&lt;/p&gt;

&lt;p&gt;è€Œåœ¨æœ€æ–°çš„master branchä¸Šï¼ŒAirflowå¯¹æ–‡ä»¶çš„ç»„ç»‡è·¯å¾„åšäº†è¾ƒå¤§çš„è°ƒæ•´ï¼Œç»™æ‰€æœ‰ç¬¬ä¸‰æ–¹çš„providerså»ºç«‹äº†ç›®å½•ï¼ŒæŠŠä¸åŒä½ç½®çš„ç›¸å…³codeéƒ½ç»Ÿä¸€æ”¾åˆ°äº†ä¸€å—ã€‚ä¾‹å¦‚ï¼Œä¸Slackç›¸å…³çš„codeéƒ½ç»Ÿä¸€æŒªåˆ°äº†&lt;em&gt;airflow/providers/slack&lt;/em&gt;ä¸‹ï¼Œä¸Šé¢çš„ä¸¤ä¸ªslack operatorçš„æ–‡ä»¶éƒ½ä½äº&lt;em&gt;airflow/providers/slack/operators&lt;/em&gt;ä¸‹ï¼Œæ–‡ä»¶çš„ç»„ç»‡æ›´ä¸ºæ¸…æ™°ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢ï¼Œä»¥&lt;code class=&quot;highlighter-rouge&quot;&gt;SlackWebhookOperator&lt;/code&gt;ä¸ºä¾‹ï¼Œä»‹ç»æ€ä¹ˆå‘Slackå‘æŠ¥è­¦é€šçŸ¥ã€‚attachmentsä¸ºä¸€ä¸ªjsonæ•°ç»„ï¼Œå®šä¹‰è§&lt;a href=&quot;#https://api.slack.com/messaging/composing/layouts#attachments&quot;&gt;slack api&lt;/a&gt;ã€‚åŒæ ·ï¼Œä¹Ÿéœ€è¦ä¸ºslackå»ºç«‹ä¸€ä¸ªconnectionã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠwebhook_tokenå­˜åœ¨passwordé‡Œã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;send_alert_to_slack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;slack_webhook_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BaseHook&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SLACK_CONN_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;attachments&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;failed_alert&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SlackWebhookOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'slack_notify'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;http_conn_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SLACK_CONN_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;webhook_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;slack_webhook_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attachments&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attachments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;slack alert message&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Airflow-alert'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;link_names&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;channel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SLACK_CHANNEL&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;failed_alert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å®Œæˆåï¼Œå°±å¯ä»¥åœ¨å¯¹åº”çš„slack channelé‡Œæ”¶åˆ°æŠ¥è­¦äº†ï¼Œæ•ˆæœå¦‚ä¸‹ï¼ˆå›¾ç‰‡æ¥è‡ªäºslackå®˜ç½‘ï¼‰ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/Airflow/slack.png&quot; alt=&quot;image-20200416202732049&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ä¸opsgenieé›†æˆè·å–oncaller&quot;&gt;ä¸Opsgenieé›†æˆè·å–oncaller&lt;/h3&gt;

&lt;p&gt;ç»è¿‡ä¸Šé¢å‡ ä¸ªæ­¥éª¤ï¼Œå·²ç»å¯ä»¥æˆåŠŸçš„æŠŠæŠ¥è­¦åŒæ—¶å‘åˆ°é‚®ç®±å’ŒSlackä¸­äº†ã€‚ä½†æ˜¯ï¼Œå‘é€åˆ°Slack channelé‡Œçš„æ¶ˆæ¯ï¼Œé»˜è®¤çš„Notificationsè®¾ç½®æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;just @mensions&lt;/code&gt;ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤éæ”¹äº†è®¾ç½®ï¼Œå¯¹äºchannelé‡Œçš„æ²¡æœ‰@ç»™ä½ çš„æ¶ˆæ¯Slackæ˜¯ä¸ä¼šå‘ä½ æ¨é€çš„ï¼Œéœ€è¦ä½ æ‰“å¼€å¯¹åº”çš„channelæ‰èƒ½çœ‹åˆ°ã€‚æ‰€ä»¥ä¸ºäº†ä¸é”™è¿‡æŠ¥è­¦ï¼Œè¿˜éœ€è¦å‘æ¶ˆæ¯æ—¶@åˆ°å…·ä½“çš„äººã€‚&lt;/p&gt;

&lt;p&gt;é‚£ä¹ˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;@who&lt;/code&gt; åˆé€‚å‘¢ï¼Ÿç›¸ä¿¡å¤§å¤šæ•°teaméƒ½ä¼šæœ‰è½®æµoncallçš„æœºåˆ¶ï¼Œæˆ–æ˜¯æŒ‡å®šåŠŸèƒ½æ¨¡å—çš„è´Ÿè´£äººï¼Œæˆ‘ä»¬åªè¦èƒ½é€šè¿‡æŸç§æ–¹æ³•è·å–åˆ°è¿™ä¸ªoncalleræˆ–è´Ÿè´£äººï¼ŒæŠŠæ¶ˆæ¯&lt;code class=&quot;highlighter-rouge&quot;&gt;@him/her&lt;/code&gt;å°±å¯ä»¥äº†ã€‚ å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;@channel&lt;/code&gt;æˆ–&lt;code class=&quot;highlighter-rouge&quot;&gt;@here&lt;/code&gt;çš„æ–¹å¼é€šçŸ¥æ‰€æœ‰äººï¼Œä½†è¿™æ ·ä¼šäº§ç”Ÿå¾ˆå¤šåƒåœ¾ä¿¡æ¯ï¼Œè€Œä¸”æ•ˆæœä¹Ÿä¸å¦‚æŒ‡å®šå¤„ç†äººæ¥çš„å¥½ã€‚&lt;/p&gt;

&lt;p&gt;è¿™é‡Œä»¥&lt;strong&gt;Opsgenie&lt;/strong&gt;ä¸ºä¾‹ï¼Œä»‹ç»ä»Opsgenieè·å–oncallerï¼Œè®©å…¶åœ¨Slackä¸­åŠæ—¶æ”¶åˆ°DAGçš„æŠ¥è­¦ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;#get oncaller by http request
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;curl_cmd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;curl -X GET  'https://api.opsgenie.com/v2/schedules/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s/on-calls?scheduleIdentifierType=name&amp;amp;flat=true' --header 'Authorization: GenieKey &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s'&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;schedule_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;oncall_json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subprocess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;check_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;curl_cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;oncall&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oncall_json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;onCallRecipients&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;notify&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;@&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; @&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;oncall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;failed_alert&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SlackWebhookOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'slack_notify'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;slack alert message &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;link_names&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#this filed shoud be true to link the name with @mention
&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åˆ°æ­¤ä¸ºæ­¢ï¼Œå°±æ‰“é€ äº†ä¸€ä¸ªç›¸å¯¹å¼ºå¤§çš„æŠ¥è­¦é€šçŸ¥æœºåˆ¶ã€‚æ—¢ä¸ä¼šæ¼æŠ¥ï¼Œä¹Ÿä¸ä¼šè¿‡å¤šçš„æ‰“æ‰°åˆ°ä¸ç›¸å¹²çš„äººã€‚&lt;/p&gt;</content><author><name>jessychen</name></author><category term="Airflow" /><category term="Alert" /><category term="CS" /><summary type="html">æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œç”¨Ariflowåšä»»åŠ¡è°ƒåº¦æ˜¯ååˆ†æ–¹ä¾¿çš„ã€‚ç„¶è€Œï¼Œä»»ä½•ç¨‹åºéƒ½å…ä¸äº†é¢ä¸´æ‰§è¡Œå¤±è´¥çš„é—®é¢˜ã€‚è™½ç„¶æœ‰retryå¤§æ³•ï¼Œä½†å½“retryä¹Ÿå¤±è´¥çš„è¯ï¼Œè¿˜æ˜¯éœ€è¦äººå·¥å¹²é¢„ã€‚è¿™æ—¶å€™ï¼ŒåŠæ—¶è€Œå…¨é¢çš„æŠ¥è­¦å°±æ˜¾å¾—ç›¸å½“é‡è¦ã€‚ä»Šå¤©ï¼Œå°±æ¥ä»‹ç»ä¸‹Airflowä¸­çš„æŠ¥è­¦æœºåˆ¶ã€‚åŒ…æ‹¬ï¼š</summary></entry><entry><title type="html">MiniProjä¹‹å¤è¯—è¯æ£€ç´¢Demoå®ç°</title><link href="https://kiwijia.work/2020/04/13/poem-demo/" rel="alternate" type="text/html" title="MiniProjä¹‹å¤è¯—è¯æ£€ç´¢Demoå®ç°" /><published>2020-04-13T00:00:00+08:00</published><updated>2020-04-13T00:00:00+08:00</updated><id>https://kiwijia.work/2020/04/13/poem-demo</id><content type="html" xml:base="https://kiwijia.work/2020/04/13/poem-demo/">&lt;p&gt;è·ç¦»ä¸Šæ¬¡å®Œæˆç®€å•çš„å¤è¯—è¯æ£€ç´¢ï¼ˆè§ &lt;a href=&quot;/2020/03/31/poem&quot;&gt;MiniProjä¹‹å¤è¯—è¯æ£€ç´¢&lt;/a&gt;ï¼‰ ä¹Ÿæœ‰æ®µæ—¶é—´äº†ã€‚å› ä¸ºéœ€è¦åŸŸåå¤‡æ¡ˆçš„å…³ç³»ï¼Œåœ¨è…¾è®¯äº‘ä¸Šä¹°äº†ä¸€å¹´çš„æœåŠ¡å™¨ã€‚æƒ³ç€æ”¾ç€ä¹Ÿæ˜¯æµªè´¹ï¼Œå‰å‡ å¤©å°±æŠ˜è…¾äº†ä¸€æŠŠï¼Œåœ¨ä¸Šé¢æ­äº†ä¸ªç®€å•çš„apiæœåŠ¡ï¼ŒåˆåŠ äº†ä¸ªé™æ€é¡µé¢ã€‚ç°åœ¨å·²ç»å¯ä»¥å®ç°åœ¨ç½‘é¡µä¸Šå¯¹å¤è¯—è¯è¿›è¡Œç®€å•æ£€ç´¢äº†ï¼š&lt;a href=&quot;/lab/poem.html&quot;&gt;poem&lt;/a&gt;ï¼Œæ•ˆæœè¿˜æ˜¯ä¸é”™çš„ã€‚ä»Šå¤©ï¼Œæ•´ç†ä¸€ä¸‹è¿™å…¶ä¸­ç”¨åˆ°çš„ä¸€äº›æŠ€æœ¯ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#mysql&quot;&gt;Mysql&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#nginxuwsgiflask&quot;&gt;Nginx+uwsgi+flask&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#è…¾è®¯äº‘api-gateway&quot;&gt;è…¾è®¯äº‘API-Gateway&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;mysql&quot;&gt;Mysql&lt;/h3&gt;

&lt;p&gt;é¦–å…ˆï¼Œè¦åšæˆserviceè°ƒç”¨ï¼Œè€ƒè™‘åˆ°æ€§èƒ½é—®é¢˜ï¼Œè‚¯å®šä¸èƒ½ç”¨ç›´æ¥è¯»jsonæ–‡ä»¶çš„æ–¹å¼æ¥åšæ£€ç´¢äº†ã€‚é‚£ä¹ˆéœ€è¦ä¸€ä¸ªæ•°æ®åº“å­˜å‚¨è¿™äº›è¯—è¯æ•°æ®ã€‚è¿™é‡Œç”¨äº†æ€§ä»·æ¯”åˆé€‚çš„mysqlï¼ˆä¸»è¦æ˜¯ä¸Šæ‰‹ç®€å•ï¼‰ã€‚&lt;/p&gt;

&lt;h4 id=&quot;åˆå§‹åŒ–&quot;&gt;åˆå§‹åŒ–&lt;/h4&gt;

&lt;p&gt;åˆå§‹åŒ–çš„å·¥ä½œåŒ…æ‹¬mysqlå®‰è£…å’Œç”¨æˆ·æƒé™è®¾ç½®ã€‚ç®€å•èµ·è§ï¼Œmysqlç›´æ¥ç”¨äº†dockeré‡Œçš„ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;docker pull mysql:latest
docker run &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 3306:3306 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; mysql &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_ROOT_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; mysql
docker ps  &lt;span class=&quot;c&quot;&gt;#åˆ—å‡ºå®¹å™¨,å¯ä»¥çœ‹åˆ°mysqlçš„container&lt;/span&gt;
docker &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; mysql /bin/bash &lt;span class=&quot;c&quot;&gt;#è¿›å…¥å®¹å™¨&lt;/span&gt;
mysql &lt;span class=&quot;nt&quot;&gt;-uroot&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#è¿›å…¥mysql&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åï¼Œå»ºç«‹æ–°userï¼Œå’Œæ–°DBï¼Œä»¥åå°±ç”¨è¿™ä¸ªuserå»è¿æ•°æ®åº“äº†ã€‚å½“ç„¶æ˜¯è¦ç‰¢ç‰¢é™åˆ¶userç”¨æˆ·çš„æƒé™æ»´ã€‚å®Œæˆåè®°å¾—è¯•ä¸€ä¸‹æ–°ç”¨æˆ·èƒ½ä¸èƒ½é¡ºåˆ©ç™»é™†ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;mysql&amp;gt; create user &lt;span class=&quot;s2&quot;&gt;&quot;api&quot;&lt;/span&gt;@&lt;span class=&quot;s2&quot;&gt;&quot;localhost&quot;&lt;/span&gt; identified by &lt;span class=&quot;s2&quot;&gt;&quot;user_password&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
mysql&amp;gt; create database api&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
mysql&amp;gt; grant &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt;,update,insert,delete on api.&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; to &lt;span class=&quot;s2&quot;&gt;&quot;api&quot;&lt;/span&gt;@&lt;span class=&quot;s2&quot;&gt;&quot;localhost&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 
mysql&amp;gt; flush privileges&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;å»ºåº“å»ºè¡¨&quot;&gt;å»ºåº“å»ºè¡¨&lt;/h4&gt;

&lt;p&gt;ç„¶åï¼Œç»™æ¯ç§ä¸åŒç±»å‹çš„è¯—è¯å»ºtableï¼Œä»¥å…¨å”è¯—å’Œå®‹è¯ä¸ºä¾‹ï¼Œç»™titleå’Œautoréƒ½åŠ äº†ç´¢å¼•ã€‚åŒæ—¶åŠ äº†è‡ªå¢ç´¢å¼•&lt;code class=&quot;highlighter-rouge&quot;&gt;id&lt;/code&gt;å­—æ®µï¼Œè¿™æ˜¯ä¸ºäº†èƒ½å¿«é€Ÿçš„éšæœºå–åˆ°ç»“æœï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-mysql&quot;&gt;CREATE TABLE `tang` (
  `id` int NOT NULL AUTO_INCREMENT,
  `author` varchar(16) DEFAULT NULL,
  `title` varchar(64) DEFAULT NULL,
  `paragraphs` text,
  `tags` text,
  `uid` varchar(64) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `i_title` (`title`),
  KEY `i_author` (`author`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

CREATE TABLE `song` (
  `id` int NOT NULL AUTO_INCREMENT,
  `author` varchar(16) DEFAULT NULL,
  `rhythmic` varchar(64) DEFAULT NULL,
  `paragraphs` text,
  `tags` text,
  PRIMARY KEY (`id`),
  KEY `i_rhythmic` (`rhythmic`),
  KEY `i_author` (`author`)
) ENGINE=InnoDB AUTO_INCREMENT=21054 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åˆ°æ­¤ï¼Œå‡†å¤‡å·¥ä½œå°±ç»“æŸäº†ã€‚æ¥ä¸‹æ¥ï¼Œéœ€è¦æŠŠjsonæ–‡ä»¶é‡Œçš„æ•°æ®è½¬æ¢æˆCSVæ ¼å¼ï¼Œç„¶åå¯¼å…¥mysqlæ–¹ä¾¿æŸ¥è¯¢ã€‚&lt;/p&gt;

&lt;h4 id=&quot;æ•°æ®è½¬æ¢&quot;&gt;æ•°æ®è½¬æ¢&lt;/h4&gt;

&lt;p&gt;è¿™æ­¥ï¼Œéœ€è¦å†™ä¸ªè„šæœ¬æ¥åšè½¬æ¢ï¼Œè¿˜æ˜¯ç”¨äº†pythonæ¥å®ç°ã€‚è¿™ä¸€æ­¥çœ‹ä¼¼ç®€å•ï¼Œä½†å…¶å®pythonçš„ä¸­æ–‡ç¼–ç æ˜¯ä¸ªå¤§å‘ï¼ŒæŠ˜è…¾äº†æˆ‘å¥½ä¹…ğŸ˜­ã€‚å³ä½¿åˆ°äº†python3ï¼Œå¯¹ä¸­æ–‡çš„æ”¯æŒä»ç„¶ä¸å°½äººæ„ã€‚å¦‚æœé‡åˆ°ç¼–ç æŠ¥é”™ï¼Œåªèƒ½æŒ¨ä¸ªæ‰¾æ–¹æ³•è§£å†³äº†ã€‚å¹¶ä¸”ï¼Œæ³¨æ„åœ¨ç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;json.dumps&lt;/code&gt;çš„æ—¶å€™åŠ å‚æ•°&lt;code class=&quot;highlighter-rouge&quot;&gt;ensure_ascii=False&lt;/code&gt;ï¼Œè¦ä¸ç„¶è¿”å›çš„ç»“æœå°±æ˜¯unicodeç¼–ç çš„sträº†ã€‚å®Œæ•´çš„ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;# -*- coding: utf-8 -*-
&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'''this script is to convert json to csv for loding into mysql'''&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;codecs&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;codecs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getwriter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;detach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;poem_path_prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;./data&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;poem_type_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;tang&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;song&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;yuan&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#poem_type_list = [&quot;tang&quot;, &quot;song&quot;, &quot;yuan&quot;, &quot;shijing&quot;]
&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;current poem type: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;poem_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_path_prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;fw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s.csv&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;w+&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;endswith&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.json&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;poems&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;r&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;tang&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;fw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'paragraphs'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ensure_ascii&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'tags'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ensure_ascii&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'tags'&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;[]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'id'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;song&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;fw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;rhythmic&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'paragraphs'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ensure_ascii&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'tags'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ensure_ascii&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'tags'&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'[]'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;yuan&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;fw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;paragraphs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ensure_ascii&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;shijing&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;fw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s|&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;chapter&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;section&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ensure_ascii&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'__main__'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿è¡Œåï¼Œç”Ÿæˆäº†4ä¸ªæˆ‘ä»¬éœ€è¦çš„dataæ–‡ä»¶ã€‚è¿™é‡Œï¼Œç”¨â€|â€œä½œä¸ºæ¯åˆ—çš„åˆ†éš”ç¬¦ï¼Œæ˜¯ä¸ºäº†ä¿è¯å’Œæ–‡æœ¬ä¸­åŸæ¥çš„å­—ç¬¦æ²¡æœ‰é‡å¤ã€‚ç„¶åï¼Œå†æŠŠå®ƒä»¬æ”¾åˆ°mysqlçš„å®¹å™¨ä¸­ï¼Œå…¥åº“ï¼Œä»¥ã€Šè¯—ç»ã€‹ä¸ºä¾‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;docker &lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;tang.csv mysql:/data/tang.csv
&lt;span class=&quot;c&quot;&gt;#enter mysql use root&lt;/span&gt;
mysql&amp;gt; load data infile &lt;span class=&quot;s1&quot;&gt;'/data/shijing.csv'&lt;/span&gt; ignore into table shijing FIELDS TERMINATED BY &lt;span class=&quot;s1&quot;&gt;'|'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ohhhï¼ŒæŠ¥é”™äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it cannot execute this statement&lt;/code&gt;ã€‚è¿™æ˜¯å› ä¸ºåœ¨å®‰è£…MySQLçš„æ—¶å€™é™åˆ¶äº†å¯¼å…¥ä¸å¯¼å‡ºçš„ç›®å½•æƒé™ã€‚åªå…è®¸åœ¨è§„å®šçš„ç›®å½•ä¸‹æ‰èƒ½å¯¼å…¥ã€‚åªè¦æˆ‘ä»¬æŠŠloadæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„&lt;code class=&quot;highlighter-rouge&quot;&gt;/data&lt;/code&gt;ç›®å½•åŠ å…¥åˆ°&lt;code class=&quot;highlighter-rouge&quot;&gt;secure_file_priv&lt;/code&gt;å°±å¯ä»¥äº†ã€‚æ–¹æ³•ä¸ºä¿®æ”¹mysqlé…ç½®æ–‡ä»¶&lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/mysql/my.conf&lt;/code&gt;ï¼ŒåŠ å…¥&lt;code class=&quot;highlighter-rouge&quot;&gt;secure-file-priv= /data&lt;/code&gt;è¿™è¡Œï¼Œç„¶åé‡å¯ã€‚dockerçš„mysqlé‡å¯å¯ä»¥ç›´æ¥é‡å¯mysql containerã€‚æ“ä½œå®Œæˆåå†è¯•ä¸€ä¸‹ï¼Œå°±èƒ½load successäº†ã€‚&lt;/p&gt;

&lt;p&gt;åˆ°è¿™æ—¶ï¼Œæˆ‘ä»¬å°±æˆåŠŸå¾—åˆ°äº†ä¸€ä¸ªå¤è¯—è¯çš„æ•°æ®åº“äº†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;nginxuwsgiflask&quot;&gt;Nginx+uwsgi+flask&lt;/h3&gt;

&lt;p&gt;æ¥ä¸‹æ¥éœ€è¦æ­å»ºä¸€ä¸ªapi serverï¼Œæ¥æ”¶å‘æ¥çš„requestï¼Œä»æ•°æ®åº“ä¸­æ£€ç´¢åè¿”å›ç»“æœã€‚ç”±äºcodeæ˜¯pythonå†™çš„ï¼Œä¸”åªéœ€è¦æä¾›ç®€å•çš„apiè°ƒç”¨æœåŠ¡ï¼Œå› è€Œé€‰ç”¨äº†è½»é‡çš„&lt;a href=&quot;https://flask.palletsprojects.com/&quot;&gt;flask&lt;/a&gt;æ¡†æ¶ï¼Œæ­é…nginx+uwsgiæ¥è¾¾åˆ°ç›®çš„ã€‚è¿™éƒ¨åˆ†çš„æ­å»ºæ­¥éª¤åŠé…ç½®åœ¨ç½‘ä¸Šå¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‰¾åˆ°ï¼Œå°±ä¸å¤šè¯´äº†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¹‹å‰æ²¡åŠ nginxæµ‹è¯•uwsgiçš„æ—¶å€™ï¼Œæˆ‘ç”¨äº†ğŸ‘‡å‘½ä»¤æ˜¯å¯ä»¥æ­£ç¡®è¿”å›çš„ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;curl &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; post &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Content-Type: application/json&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://localhost/poem&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{}'&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¯æ˜¯åœ¨åŠ ä¸Šnginxåå´ä¸€ç›´æŠ¥&lt;code class=&quot;highlighter-rouge&quot;&gt;400 BadRequest&lt;/code&gt;çš„é”™è¯¯ã€‚ä¸€åº¦è®¤ä¸ºæ˜¯nginxé…ç½®çš„é—®é¢˜ï¼Œä½†æ€ä¹ˆä¹Ÿæ‰¾ä¸åˆ°åŸå› ã€‚æœ€åæ‰å‘ç°ï¼Œå¯¹nginxæ¥è¯´ï¼ŒæŒ‡å®šçš„methodæ˜¯åˆ†å¤§å°å†™çš„ï¼Œä¸Šé¢çš„curlå‘½ä»¤ä¸­çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;post&lt;/code&gt;éœ€è¦æ”¹ä¸ºå¤§å†™çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;POST&lt;/code&gt;æ‰å¯ä»¥ã€‚ä¿®æ”¹åæœç„¶å°±æ­£å¸¸äº†ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;curl &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; POST &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Content-Type: application/json&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://localhost/poem&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{}'&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;è…¾è®¯äº‘api-gateway&quot;&gt;è…¾è®¯äº‘API-Gateway&lt;/h3&gt;

&lt;p&gt;å…¶å®å®Œæˆä¸Šé¢è¿™æ­¥ï¼Œå¦‚æœè‡ªå·±æœ‰åŸŸåçš„è¯ï¼Œå°±å¯ä»¥è®©å‰ç«¯ç›´æ¥è®¿é—®å¯¹åº”çš„api serveräº†ã€‚ä½†ç”±äºæˆ‘çš„åŸŸåè¿˜åœ¨å¤‡æ¡ˆï¼Œæ‰€ä»¥è¿™é‡Œç”¨äº†è…¾è®¯äº‘çš„API gatewayåšäº†ä¸€æ¬¡è½¬å‘ã€‚API Gatewayçš„ä½¿ç”¨æ–¹æ³•å¯ä»¥è§ä¹‹å‰çš„æ–‡ç« &lt;a href=&quot;/2020/03/27/api-scf/#api&quot;&gt;API&lt;/a&gt;ã€‚åªè¦åœ¨åç«¯è®¾ç½®ä¸­æŒ‡å®šâ€&lt;strong&gt;åç«¯åŸŸå&lt;/strong&gt;â€œä¸ºCVMåœ°å€ï¼Œè·¯å¾„ä¸ºAPIçš„è·¯å¾„å°±å¯ä»¥äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/MiniProj/poem.png&quot; alt=&quot;image-20200413154040491&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;æ³¨æ„ï¼šå½“ä¸å¼€å¯VPCæ—¶ï¼ŒæœåŠ¡åœ°å€IPéœ€å¡«å†™å…¬ç½‘IPï¼Œè‹¥ä¸šåŠ¡æœåŠ¡å™¨å®‰å…¨ç­–ç•¥æœ‰è¦æ±‚ï¼Œå¯ä»…æ”¾é€šAPIç½‘å…³IPçš„è®¿é—®ï¼ˆè¯·å‚è€ƒ&lt;a href=&quot;https://cloud.tencent.com/document/product/628/39963&quot;&gt;APIç½‘å…³çš„å…¬ç½‘VIPåˆ—è¡¨&lt;/a&gt;ï¼‰ã€‚å¼€å¯VPCåï¼Œè¯·ä»åˆ—è¡¨ä¸­é€‰æ‹©ä½ éœ€è¦ç»‘å®šçš„CLBä»¥åŠç›‘å¬å™¨ã€‚&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œæœ€åä¸€æ­¥æ˜¯åœ¨nginxçš„é…ç½®ä¸­å»ºç«‹IPç™½åå•ï¼Œåªå…è®¸è…¾è®¯äº‘APIç½‘å…³çš„IPè®¿é—®è¿™ä¸ªæ¥å£ã€‚&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;http &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  ...
  include black.ip&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  ...
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#in black.ip&lt;/span&gt;
allow xx.xx.xx.xx&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
deny all&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;æ‰€æœ‰å·¥ä½œå®Œæˆåï¼Œæ¬£èµä¸€ä¸‹æˆæœå§ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/MiniProj/poem.gif&quot; alt=&quot;image-poem&quot; /&gt;&lt;/p&gt;</content><author><name>jessychen</name></author><category term="Python" /><category term="CS" /><category term="MiniProj" /><category term="Cloud" /><summary type="html">è·ç¦»ä¸Šæ¬¡å®Œæˆç®€å•çš„å¤è¯—è¯æ£€ç´¢ï¼ˆè§ MiniProjä¹‹å¤è¯—è¯æ£€ç´¢ï¼‰ ä¹Ÿæœ‰æ®µæ—¶é—´äº†ã€‚å› ä¸ºéœ€è¦åŸŸåå¤‡æ¡ˆçš„å…³ç³»ï¼Œåœ¨è…¾è®¯äº‘ä¸Šä¹°äº†ä¸€å¹´çš„æœåŠ¡å™¨ã€‚æƒ³ç€æ”¾ç€ä¹Ÿæ˜¯æµªè´¹ï¼Œå‰å‡ å¤©å°±æŠ˜è…¾äº†ä¸€æŠŠï¼Œåœ¨ä¸Šé¢æ­äº†ä¸ªç®€å•çš„apiæœåŠ¡ï¼ŒåˆåŠ äº†ä¸ªé™æ€é¡µé¢ã€‚ç°åœ¨å·²ç»å¯ä»¥å®ç°åœ¨ç½‘é¡µä¸Šå¯¹å¤è¯—è¯è¿›è¡Œç®€å•æ£€ç´¢äº†ï¼špoemï¼Œæ•ˆæœè¿˜æ˜¯ä¸é”™çš„ã€‚ä»Šå¤©ï¼Œæ•´ç†ä¸€ä¸‹è¿™å…¶ä¸­ç”¨åˆ°çš„ä¸€äº›æŠ€æœ¯ã€‚</summary></entry><entry><title type="html">Airflowä¸­åˆ©ç”¨Variableç”ŸæˆåŠ¨æ€DAG</title><link href="https://kiwijia.work/2020/04/12/dynamic-dag/" rel="alternate" type="text/html" title="Airflowä¸­åˆ©ç”¨Variableç”ŸæˆåŠ¨æ€DAG" /><published>2020-04-12T00:00:00+08:00</published><updated>2020-04-12T00:00:00+08:00</updated><id>https://kiwijia.work/2020/04/12/dynamic-dag</id><content type="html" xml:base="https://kiwijia.work/2020/04/12/dynamic-dag/">&lt;blockquote&gt;
  &lt;p&gt;In Airflow, a &lt;strong&gt;DAG&lt;/strong&gt; â€“ or a Directed Acyclic Graph â€“ is a collection of all the tasks you want to run, organized in a way that reflects their relationships and dependencies.&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;Variables&lt;/strong&gt; are a generic way to store and retrieve arbitrary content or settings as a simple key value store within Airflow.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;DAG&lt;/strong&gt;ä½œä¸ºAirflowä¸­è‡³å…³é‡è¦çš„æ¦‚å¿µï¼Œç›¸ä¿¡ä½ ä¸€å®šä¸ä¼šé™Œç”Ÿã€‚è€Œ&lt;strong&gt;Variables&lt;/strong&gt;ï¼Œåˆ™æ˜¯Airflowåœ¨DBä¸­ä»¥KVå½¢å¼å­˜å‚¨çš„ä¸€äº›å˜é‡ï¼Œæ–¹ä¾¿DAGåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä½¿ç”¨ã€‚å¯èƒ½æœ‰äººä¼šè§‰çš„&lt;strong&gt;Variables&lt;/strong&gt;å’Œ&lt;strong&gt;Xcom&lt;/strong&gt;å¾ˆç›¸ä¼¼ï¼Œå®é™…ä¸Šç¡®å®ä¹Ÿæ˜¯ã€‚å®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼šXComè®¾è®¡çš„åˆè¡·æ˜¯ç”¨äºDAGå†…éƒ¨taskä¹‹é—´çš„æ•°æ®å…±äº«ï¼ˆå½“ç„¶ä¼šæœ‰ä¸€äº›æ–¹æ³•å¯ä»¥è·å–åˆ°å…¶ä»–DAGçš„XComï¼Œä½†ä¸æ¨èè¿™ä¹ˆåšï¼‰ï¼Œè€ŒVariablesåˆ™æ˜¯è·¨DAGçš„å­˜åœ¨ã€‚å…³äºXComçš„ä»‹ç»å¯ä»¥çœ‹ä¸Šç¯‡æ–‡ç« &lt;a href=&quot;/2020/04/06/xcom&quot;&gt;Airflowä¸­åˆ©ç”¨xcomå®ç°taské—´ä¿¡æ¯ä¼ é€’&lt;/a&gt;ã€‚æ›´å¤šAirflowçš„åŸºç¡€æ¦‚å¿µï¼Œå‚è€ƒå®˜æ–¹æ–‡æ¡£&lt;a href=&quot;https://airflow.apache.org/docs/stable/concepts.html&quot;&gt;Airflow Concepts&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹é¢è¿›å…¥ä¸»é¢˜ï¼Œä»Šå¤©å‘å¤§å®¶ä»‹ç»ä¸€ç§åˆ©ç”¨Variableç”ŸæˆåŠ¨æ€DAGçš„æ–¹æ³•ã€‚ä¸ºä»€ä¹ˆè¦åŠ¨æ€ç”ŸæˆDAGå‘¢ï¼Ÿåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šé‡åˆ°ä¸‹é¢å‡ ç§æƒ…å†µï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;éœ€è¦ç”Ÿæˆå¤šä¸ªç±»ä¼¼çš„DAGã€‚å¯èƒ½å®ƒä»¬ä¹‹é—´åªæ˜¯scheduleæ—¶é—´ï¼Œæˆ–æŸäº›é…ç½®ä¸åŒï¼Œå› è€Œæˆ‘ä»¬ä¸æƒ³ä¸ºæ¯ä¸ªDAGé‡å¤å†™ç±»ä¼¼çš„pythonæ–‡ä»¶ã€‚&lt;/li&gt;
  &lt;li&gt;æŸä¸ªDAGï¼Œå†…éƒ¨taskçš„æ•°é‡æˆ–ç±»å‹ä¼šéšå¤–éƒ¨æ¡ä»¶å˜åŒ–ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;é‚£ä¹ˆå¯¹äºä¸Šé¢ä¸¤ç§æƒ…å†µï¼Œæœ‰æ²¡æœ‰å¯è¡Œçš„å®ç°æ–¹æ¡ˆå‘¢ï¼Ÿæ—¢ç„¶æœ‰è¿™ç¯‡æ–‡ç« ï¼Œç­”æ¡ˆè‡ªç„¶æ˜¯è‚¯å®šçš„ã€‚è¿™é‡Œç»™å‡ºä¸€ç§è§£å†³æ‰‹æ®µï¼šåˆ©ç”¨Variablesæ¥å­˜å‚¨DAGç”Ÿæˆéœ€è¦çš„å‚æ•°ï¼Œä»è€Œå®ç°DAGçš„åŠ¨æ€åˆ›å»ºã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;ç”Ÿæˆå¤šä¸ªç±»ä¼¼dag&quot;&gt;ç”Ÿæˆå¤šä¸ªç±»ä¼¼DAG&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼š æ–°æ—¶ä»£ä»¥HARDæ¨¡å¼è¯ç”Ÿçš„SamåŒå­¦ï¼Œæ¯å¤©çš„å­¦ä¹ å®‰æ’çš„æ»¡æ»¡å½“å½“çš„ï¼š&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;å‘¨ä¸€åˆ°å‘¨äº”&lt;/strong&gt;ï¼šï¼ˆ7:00å¼€å§‹ï¼‰&lt;/p&gt;

  &lt;div class=&quot;mermaid&quot;&gt;
graph LR
A(&quot;Go(School)&quot;)--&amp;gt;B(&quot;Go(InterestClass)&quot;);
B--&amp;gt;C(DoHomework);
&lt;/div&gt;
  &lt;p&gt;&lt;strong&gt;å‘¨å…­åˆ°å‘¨æ—¥&lt;/strong&gt;ï¼šï¼ˆ8:00å¼€å§‹ï¼‰&lt;/p&gt;

  &lt;div class=&quot;mermaid&quot;&gt;
graph LR
A(&quot;Go(Park)&quot;)--&amp;gt;B(&quot;Go(InterestClass)&quot;);
B--&amp;gt;C(DoHomework);
&lt;/div&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ ¹æ®ä¸Šé¢åœºæ™¯ï¼Œå¦‚æœæƒ³ä¸ºæ¯å¤©çš„å­¦ä¹ å®‰æ’ç”Ÿæˆä¸€ä¸ªDAGï¼Œå¯ä»¥æ€ä¹ˆåšå‘¢ï¼Ÿæœ€ç®€å•çš„æ–¹æ³•ï¼Œå½“ç„¶æ˜¯å†™ä¸ƒä¸ªpythonæ–‡ä»¶æ¥å®ç°ã€‚ä¸è¿‡è¿™æ ·ä¼šæœ‰å¤§é‡é‡å¤ä»£ç ï¼Œè‚¯å®šæ˜¯ä¸æ¨èçš„ï¼Œä½ ä¹Ÿä¸ä¼šé‚£ä¹ˆåšã€‚&lt;/p&gt;

&lt;p&gt;ç¬¬äºŒç§æ–¹æ³•ï¼Œæ˜¯ä¸ºå‘¨ä¸€åˆ°å‘¨äº”å’Œå‘¨å…­æ—¥åˆ†åˆ«ä»¥å¾ªç¯çš„æ–¹å¼æ„å»ºå‡ºDAGï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;workday&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;weekday_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;workday&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DAG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;default_args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;schedule_interval&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'0 7 * * &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;workday&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;globals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;go_school_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PythonOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'go_school'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;python_callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;go_study&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;op_kwargs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'target'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;school&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#Simplify Other Operators generate
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;go_school_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;go_interest_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_homework_op&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;holiday&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;weekday_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;holiday&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DAG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;default_args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;schedule_interval&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'0 8 * * &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;holiday&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;globals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;go_park_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PythonOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'go_park'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;python_callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;go_study&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;op_kwargs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'target'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;park&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#Simplify Other Operators generate
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;go_park_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;go_interest_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_homework_op&lt;/span&gt;

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å‘¨ä¸­å’Œå‘¨æœ«çš„å®‰æ’å…¶å®æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä¸å¯ä»¥æŠŠå®ƒä»¬è¿›ä¸€æ­¥åˆå¹¶å‘¢ï¼Ÿçœ‹ä¸‹é¢ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;weekday_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DAG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;default_args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;schedule_interval&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'0 &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d * * &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;globals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;park&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;school&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;go_study_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PythonOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'go_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;python_callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;go_study&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;op_kwargs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'target'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#Simplify Other Operators generate
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;go_study_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;go_interest_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_homework_op&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å†è¿›ä¸€æ­¥çœ‹ï¼Œå¦‚æœåˆ°äº†åˆä¸‰æˆ–é«˜ä¸‰ï¼Œå¯èƒ½å­¦æ ¡ä¼šè¦æ±‚å‘¨æœ«ä¹Ÿå»å­¦æ ¡è¡¥è¯¾ï¼Œæˆ–è€…è°ƒæ•´åˆ°æ ¡æ—¶é—´ä»€ä¹ˆçš„ã€‚é‚£æ ·æˆ‘ä»¬å°±éœ€è¦å»æ”¹codeäº†ã€‚è¿™æ—¶å€™å¯ä»¥ç”¨ä¸ŠVariableçš„é…ç½®åŠŸèƒ½ï¼Œåªç”¨åœ¨UIä¸Šæ”¹ä¸‹é…ç½®å°±è¾¾åˆ°è°ƒæ•´çš„ç›®çš„ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'weekday_schedule'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;key,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;json:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;park&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;school&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;school&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;school&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;school&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;5&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;school&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;6&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;park&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹åçš„DAGæœ€ç»ˆå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;weekday_schedule&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;weekday_schedule&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deserialize_json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;weekday_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DAG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;default_args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;schedule_interval&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'0 &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d * * &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;globals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;go_study_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PythonOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'go_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;python_callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;go_for_study&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;op_kwargs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'target'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]},&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#Simplify Other Operators generate
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;go_study_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;go_interest_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_homework_op&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;åŠ¨æ€æ§åˆ¶dagå†…tasks&quot;&gt;åŠ¨æ€æ§åˆ¶DAGå†…tasks&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;åœºæ™¯&lt;/strong&gt;ï¼šæƒ³æ›´ç»†åŒ–ä¸€ä¸‹Samæ¯å¤©ä¸Šè¯¾çš„ç§‘ç›®å’Œæ•°é‡ï¼Œæ¯å¤©æ ¹æ®è¯¾ç¨‹è¡¨ä¸ºæ¯èŠ‚è¯¾æ„å»ºä¸€ä¸ªTaskï¼ŒæŠŠä¸Šç¬¬ä¸€ä¸ªGo(***) task æ›¿æ¢æˆå…·ä½“çš„è¯¾ç¨‹ï¼Œç±»ä¼¼ï¼š&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;å‘¨ä¸€&lt;/strong&gt;ï¼šï¼ˆ7:00å¼€å§‹ï¼‰&lt;/p&gt;

  &lt;div class=&quot;mermaid&quot;&gt;
graph LR
A(Chinese)--&amp;gt;B(Art);
B--&amp;gt;C(English);
C--&amp;gt;D(PEclass);
&lt;/div&gt;

  &lt;p&gt;&lt;strong&gt;å‘¨äºŒ&lt;/strong&gt;ï¼šï¼ˆ7:00å¼€å§‹ï¼‰&lt;/p&gt;

  &lt;div class=&quot;mermaid&quot;&gt;
graph LR
A(Math)--&amp;gt;B(PEclass);
B--&amp;gt;C(Chinese);
C--&amp;gt;D(Art);
&lt;/div&gt;

  &lt;p&gt;&lt;strong&gt;å‘¨å…­&lt;/strong&gt;ï¼šï¼ˆ8:00å¼€å§‹ï¼‰&lt;/p&gt;

  &lt;div class=&quot;mermaid&quot;&gt;
graph LR
A(PEclass)--&amp;gt;B(Math);
B--&amp;gt;C(English);
&lt;/div&gt;
&lt;/blockquote&gt;

&lt;p&gt;åŒæ ·ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ¯å¤©çš„è¯¾ç¨‹æ„å»ºä¸€ä¸ªDAGã€‚è¿™äº›DAGçš„æŸäº›ç»„æˆæ¥è‡ªä¸€ç¾¤ç›¸åŒçš„tasksï¼ˆç§‘ç›®ï¼‰ï¼Œä½†æ¯ä¸ªDAGä¸­çš„taskså®ä¾‹åŠæ•°ç›®åˆå„ä¸ç›¸åŒã€‚æ›´æ¼ç«çš„æ˜¯ï¼Œè¿™äº›tasksçš„ç»„åˆï¼ˆè¯¾ç¨‹è¡¨ï¼‰å¯èƒ½æ—¶ä¸æ—¶ï¼ˆæ¯å­¦æœŸï¼‰ä¼šå˜åŒ–ã€‚å¦‚æœç›´æ¥å›ºå®šçš„å†™åœ¨Codeé‡Œï¼Œç»å¯¹ä¼šæ˜¯åœºç¾éš¾ã€‚æ‰€ä»¥ï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯æŠŠè¿™ç§ç»„åˆå…³ç³»å†™åˆ°é…ç½®ï¼ˆVariableï¼‰é‡Œï¼Œæ–¹ä¾¿éšæ—¶æ›´æ–°ã€‚&lt;/p&gt;

&lt;p&gt;Variableé‡Œçš„å†…å®¹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;err&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'weekday_schedule'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;key,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;is&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;json:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;park&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;classes&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;PEclass&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Chinese&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Art&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;school&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;classes&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Chinese&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Art&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;English&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;PEclass&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;school&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;classes&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Math&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;PEclass&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Chinese&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Art&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;......&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;6&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;park&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;classes&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;PEclass&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Math&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;English&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;DAGå®ç°Codeï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;weekday_schedule&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;weekday_schedule&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;deserialize_json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday_schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;weekday_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DAG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;default_args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;schedule_interval&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'0 &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d * * &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;start&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weekday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;globals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;classes&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;last_study_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;classes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;go_study_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PythonOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s_class_at_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;python_callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;go_study&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;op_kwargs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'target'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;target&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'class_type'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_study_op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;last_study_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;go_study_op&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;last_study_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;go_study_op&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;#Simplify Other Operators generate
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;last_study_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;go_interest_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_homework_op&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;é€šè¿‡è¿™ç§å†™æ³•ï¼Œä¸ç®¡ä¸Šè¯¾çš„æ—¶é—´ã€åœ°ç‚¹ã€å†…å®¹æ€æ ·å˜åŒ–ï¼Œåªè¦ä¸€ä»½codeå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„æŒ‰éœ€ç”Ÿæˆæ–°çš„DAGã€‚ä¸è¿‡ï¼Œè¿™ä¹ˆå†™çš„è¯Variableçš„é…ç½®ä¼šç¨ç¨å¤æ‚äº†ç‚¹ã€‚å¦‚æœè§‰çš„æ‰‹åŠ¨æ›´æ–°Variableå®¹æ˜“å‡ºé”™çš„è¯ï¼Œå»ºè®®å†™æˆè„šæœ¬ï¼Œåœ¨è„šæœ¬ä¸­æ‹¼è£…jsonæ•°æ®ï¼Œå†è°ƒç”¨Airflow Cliæ¥å®ç°æ›´æ–°ã€‚&lt;/p&gt;</content><author><name>jessychen</name></author><category term="Airflow" /><category term="CS" /><summary type="html">In Airflow, a DAG â€“ or a Directed Acyclic Graph â€“ is a collection of all the tasks you want to run, organized in a way that reflects their relationships and dependencies. Variables are a generic way to store and retrieve arbitrary content or settings as a simple key value store within Airflow.</summary></entry><entry><title type="html">Airflowä¸­åˆ©ç”¨xcomå®ç°taské—´ä¿¡æ¯ä¼ é€’</title><link href="https://kiwijia.work/2020/04/06/xcom/" rel="alternate" type="text/html" title="Airflowä¸­åˆ©ç”¨xcomå®ç°taské—´ä¿¡æ¯ä¼ é€’" /><published>2020-04-06T00:00:00+08:00</published><updated>2020-04-06T00:00:00+08:00</updated><id>https://kiwijia.work/2020/04/06/xcom</id><content type="html" xml:base="https://kiwijia.work/2020/04/06/xcom/">&lt;blockquote&gt;
  &lt;p&gt;XComs let tasks exchange messages, allowing more nuanced forms of control and shared state. The name is an abbreviation of â€œcross-communicationâ€.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Airflowä½œä¸ºä¸€æ¬¾ä¼˜ç§€çš„ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿï¼Œå¿…ç„¶éœ€è¦è§£å†³ä¸€ä¸ªé‡è¦é—®é¢˜ï¼š&lt;strong&gt;å¦‚ä½•åœ¨å¤šä¸ªè°ƒåº¦ä»»åŠ¡ä¸­å®ç°ä¿¡æ¯å…±äº«ï¼Ÿ&lt;/strong&gt;å³æ€ä¹ˆæŠŠtask Aæ‰§è¡Œå¾—åˆ°çš„ç»“æœä¼ é€’ç»™task Bï¼Œè®©task Bå¯ä»¥åŸºäºtask Açš„ç»“æœè¿›è¡Œåç»­æ“ä½œã€‚XComå°±æ˜¯ç»™å‡ºçš„ç­”æ¡ˆã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;#åŸºæœ¬åŸç†&quot;&gt;åŸºæœ¬åŸç†&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#pushå’Œpull&quot;&gt;Pushå’ŒPull&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#operatorçš„do_xcom_pushå‚æ•°&quot;&gt;Operatorçš„do_xcom_pushå‚æ•°&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ä¸templateç»“åˆä½¿ç”¨&quot;&gt;ä¸templateç»“åˆä½¿ç”¨&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#æ€»ç»“&quot;&gt;æ€»ç»“&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;åŸºæœ¬åŸç†&quot;&gt;åŸºæœ¬åŸç†&lt;/h3&gt;

&lt;p&gt;XComæ˜¯â€cross-communicationâ€çš„ç¼©å†™ã€‚å®ƒè¢«è®¾è®¡äºç”¨æ¥åœ¨Airflow å„ä¸ªtaské—´è¿›è¡Œæ•°æ®å…±äº«ã€‚XComå±äºAirflowçš„modelï¼Œè§&lt;code class=&quot;highlighter-rouge&quot;&gt;airflow.models.xcom.XCom&lt;/code&gt;ï¼ŒåŒ…å«ä¸‹é¢å‡ ä¸ªå­—æ®µï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;__tablename__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;xcom&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Column&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;COLLATION_ARGS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;primary_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Column&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LargeBinary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;timestamp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Column&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UtcDateTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timezone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utcnow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nullable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;execution_date&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Column&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UtcDateTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;primary_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# source information
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Column&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ID_LEN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;COLLATION_ARGS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;primary_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Column&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ID_LEN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;COLLATION_ARGS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;primary_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä»ä¸Šè¿°codeå®šä¹‰å¯ä»¥äº†è§£åˆ°ï¼ŒXComé‡Œçš„å†…å®¹å…¶å®æ˜¯å­˜åœ¨Airflow DBä¸­çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;xcom&lt;/code&gt;è¿™å¼ è¡¨é‡Œçš„ã€‚å¦‚æœé…ç½®äº†Airflow UIï¼Œå¯ä»¥å¾ˆæ–¹é¢çš„æŸ¥åˆ°å½“å‰XComé‡Œå­˜çš„æ‰€ä»¥å†…å®¹&lt;em&gt;ï¼ˆå…¥å£ä½äºAdmin-&amp;gt;XComsï¼‰&lt;/em&gt;ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/Airflow/xcom-ui.png&quot; alt=&quot;image-20200406113247869&quot; /&gt;&lt;/p&gt;

&lt;p&gt;è¡¨é‡Œçš„å­—æ®µä¸modelä¸­çš„å®šä¹‰ä¸€ä¸€å¯¹åº”ï¼Œå¾ˆå¥½ç†è§£ã€‚å…¶ä¸­&lt;em&gt;execution_date&lt;/em&gt;æ˜¯taskå¼€å§‹æ‰§è¡Œçš„æ—¶é—´ï¼Œ&lt;em&gt;timestamp&lt;/em&gt;é»˜è®¤æ˜¯è¿™æ¡è®°å½•ç”Ÿæˆçš„æ—¶é—´ã€‚å›¾ä¸Šçš„XComå­˜çš„æ˜¯å¯¹åº”çš„taskçš„è¿”å›å€¼(key=â€return_valueâ€, value=â€Successâ€œ)ã€‚å¦‚æœä½ çš„taskå®šä¹‰äº†å…¶ä»–ç±»å‹çš„è¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;return_value&lt;/code&gt;è¿™ä¸ªkeyæ¥è·å–ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æ­¤ï¼Œæ˜¾è€Œæ˜“è§ï¼ŒXComçš„æœ¬è´¨å°±æ˜¯&lt;strong&gt;æŠŠtaskéœ€è¦ä¼ é€’çš„ä¿¡æ¯ä»¥KVçš„å½¢å¼å­˜åˆ°DBä¸­&lt;/strong&gt;ï¼Œè€Œå…¶ä»–taskåˆ™å¯ä»¥ä»DBä¸­è·å–ã€‚ç”±äºXComæ˜¯å­˜åœ¨DBè€Œä¸æ˜¯å†…å­˜ä¸­ï¼Œè¿™ä¹Ÿè¯´æ˜äº†å¯¹äºå·²ç»æ‰§è¡Œå®Œçš„DAGï¼Œå¦‚æœé‡è·‘å…¶ä¸­æŸä¸ªtaskçš„è¯ä¾ç„¶å¯ä»¥è·å–åˆ°åŒæ¬¡DAGè¿è¡Œæ—¶å…¶ä»–taskä¼ é€’çš„å†…å®¹ã€‚&lt;/p&gt;

&lt;p&gt;çœ‹åˆ°è¿™é‡Œï¼Œå‘ç°ä»€ä¹ˆé—®é¢˜æ²¡ï¼Ÿæ²¡é”™ï¼Œç”±äºXComä¸ä¼šè‡ªå·±æ¸…ç†ï¼Œæ‰€ä»¥DBé‡Œçš„æ•°æ®ä¼šè¶Šæ¥è¶Šå¤šğŸ™€ã€‚è¿™é‡Œæ¨èåœ¨æ¯æ¬¡DAGæ‰§è¡Œsuccessçš„æœ€ååŠ ä¸€ä¸ªclearçš„æ“ä½œï¼Œå¯ä»¥é€šè¿‡åœ¨DAGä¸­åŠ ä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;on_success_callback&lt;/code&gt;æ¥å®ç°ï¼Œå‚è€ƒcodeå¦‚ä¸‹ï¼Œè¯·æŒ‰å®é™…æƒ…å†µè°ƒæ•´filteræ¡ä»¶ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;airflow.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DAG&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;airflow.utils.db&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;provide_session&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;airflow.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;XCom&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;provide_session&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;cleanup_xcom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'ti'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'dag_id'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;XCom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;XCom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delete&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DAG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;on_success_callback&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cleanup_xcom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;pushå’Œpull&quot;&gt;Pushå’ŒPull&lt;/h3&gt;

&lt;p&gt;ä¸‹é¢æ¥è®²è®²å¦‚ä½•å¾€XComä¸­æ·»åŠ å’Œè·å–è®°å½•ã€‚ä¸Šé¢å·²ç»è¯´äº†ï¼ŒXComå­˜å‚¨çš„æ˜¯KVå½¢å¼çš„æ•°æ®å¯¹ï¼ŒAirflowåŒ…è£…äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;xcom_push&lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;xcom_pull&lt;/code&gt;ä¸¤ä¸ªæ–¹æ³•ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œå­˜å–ï¼Œå®šä¹‰åœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;taskinstance.py&lt;/code&gt;ä¸­ï¼š&lt;a href=&quot;https://github.com/apache/airflow/blob/master/airflow/models/taskinstance.py&quot;&gt;source&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;xcom_push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;execution_date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;xcom_pull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;task_ids&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Union&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Iterable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;dag_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Optional&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;XCOM_RETURN_KEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;include_prior_dates&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæ²¡æœ‰ç‰¹æ®Šçš„éœ€æ±‚ï¼Œæˆ‘ä»¬åªéœ€å…³æ³¨é‡Œé¢çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;key&lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;value&lt;/code&gt;è¿™ä¸¤ä¸ªå‚æ•°å³å¯ã€‚å…¶ä»–å‚æ•°Airflowä¼šæ ¹æ®taskçš„ä¸Šä¸‹æ–‡è‡ªåŠ¨æ·»åŠ ã€‚çœ‹ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;PythonOperator&lt;/code&gt;çš„ä¾‹å­æ›´èƒ½è¯´æ˜ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;push_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'ti'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xcom_push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'test_key'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'test_val'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
&lt;span class=&quot;n&quot;&gt;push_data_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PythonOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'push_data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;python_callable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;push_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;provide_context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;pull_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;test_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'ti'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xcom_pull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'test_key'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
&lt;span class=&quot;n&quot;&gt;pull_data_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PythonOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'pull_data'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;python_callable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pull_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;provide_context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;push_data_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pull_data_op&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢çš„codeå°±åœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;push_data&lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;pull_data&lt;/code&gt;ä¸¤ä¸ªä»»åŠ¡ä¸­ä¼ é€’äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;key='test_key', value='test_val'&lt;/code&gt;è¿™ä¸€æ¡æ•°æ®ã€‚æ›´æ–¹ä¾¿çš„æ˜¯ï¼Œè¿™é‡Œçš„valueä¸ä»…é™äºstrç±»å‹ï¼Œè¿™å°±æä¾›äº†æ›´å¤§çš„è‡ªç”±åº¦ã€‚æ³¨æ„ï¼Œåœ¨opreatorä¸­å¿…é¡»è¦æœ‰&lt;code class=&quot;highlighter-rouge&quot;&gt;provide_context=True,&lt;/code&gt;æ‰èƒ½åœ¨operatorå†…éƒ¨é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;context['ti']&lt;/code&gt;ï¼ˆæœ‰çš„æ–‡æ¡£ç»™çš„ä¾‹å­æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;context['task_instance']&lt;/code&gt;ï¼‰è·å¾—å½“å‰taskçš„TaskInstanceï¼Œè¿›è¡ŒXCom push/pullçš„ç›¸å…³æ“ä½œã€‚&lt;/p&gt;

&lt;p&gt;æ­¤å¤–ï¼Œå¦‚æœä¸€ä¸ªtaskè¿”å›ä¸€ä¸ªå€¼ï¼ˆä»operatorçš„execute()æ–¹æ³•ï¼Œæˆ–è€…ä»PythonOperatorçš„python_callableæŒ‡å®šçš„æ–¹æ³•ï¼‰ï¼Œé‚£ä¹ˆåŒ…å«è¯¥å€¼çš„XComå°†è¢«è‡ªåŠ¨pushï¼Œé»˜è®¤çš„keyå°±æ˜¯ä¸Šé¢è§è¿‡çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;return_value&lt;/code&gt;ã€‚å®˜æ–¹æ–‡æ¡£ä¸­ç»™äº†ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œè¿™é‡Œå¯ä»¥ä¸æŒ‡å®škeyï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;# inside a PythonOperator called 'pushing_task'
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;push_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# inside another PythonOperator where provide_context=True
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;pull_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'ti'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xcom_pull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;task_ids&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'pushing_task'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¾ˆå¥½ç†è§£ï¼Œè¿™ä¸ªä¾‹å­æ˜¯é€šè¿‡ä¼ é€’&lt;code class=&quot;highlighter-rouge&quot;&gt;task_ids&lt;/code&gt;å‚æ•°æ¥è·å–å¯¹åº”taskçš„è¿”å›å€¼ã€‚è¿™é‡Œçš„&lt;code class=&quot;highlighter-rouge&quot;&gt;task_ids&lt;/code&gt;å¦‚æœä¼ é€’å¤šä¸ªï¼Œåˆ™è¿”å›ç›¸åº”tasksçš„XComå€¼åˆ—è¡¨ã€‚å½“ç„¶ï¼Œä½ è¿˜å¯ä»¥åŒæ—¶æŒ‡å®š&lt;code class=&quot;highlighter-rouge&quot;&gt;key&lt;/code&gt;å‚æ•°ï¼Œæ¥è·å–æŒ‡å®štasksé‡Œxcom_pushçš„keyå¯¹åº”çš„valueã€‚&lt;/p&gt;

&lt;h3 id=&quot;operatorçš„do_xcom_pushå‚æ•°&quot;&gt;Operatorçš„do_xcom_pushå‚æ•°&lt;/h3&gt;

&lt;p&gt;çœ‹å®Œä¸Šé¢è¿™äº›ï¼Œä½ åº”è¯¥å¯¹XComçš„ä½¿ç”¨æœ‰äº†åˆæ­¥çš„äº†è§£ã€‚å¯èƒ½åˆä¼šæœ‰è¿™æ ·çš„ç–‘é—®ï¼šAirflowæä¾›äº†ä¸å°‘é¢„å®šä¹‰çš„Operatorï¼Œæ–¹ä¾¿æˆ‘ä»¬ç›´æ¥è°ƒç”¨æ¥å®Œæˆä¸€äº›åŸºæœ¬çš„taskï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šå»æ”¹é‡Œé¢çš„å†…å®¹ã€‚é‚£ä¹ˆè¦æ€æ ·è·å–è¿™ç±»taskçš„è¾“å‡ºå‘¢ï¼Ÿè¿™å°±æ˜¯è¿™èŠ‚è¦è®²çš„å†…å®¹äº†ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;BaseOperator&lt;/code&gt;ä¸­æä¾›äº†ä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;do_xcom_push&lt;/code&gt;å‚æ•°ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_xcom_push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;an&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;XCom&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pushed&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;containing&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Operator&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'s&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;    result&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;:type do_xcom_push: bool&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;......&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;do_xcom_push: bool = True,&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;
&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åœ¨Operatorå®ç°ä¸­å¯ä»¥ç”¨è¿™ä¸ªå‚æ•°æ¥å†³å®šæ˜¯å¦å¾€XComä¼ é€’ä¸€äº›éœ€è¦çš„ä¿¡æ¯ï¼ŒBaseOperatorä¸­é»˜è®¤å€¼æ˜¯Trueã€‚æ‰¾äº†ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;DatabricksSubmitRunOperator&lt;/code&gt;ä½œä¸ºå®ç°çš„ä¾‹å­ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;#param do_xcom_push: Whether we should push run_id and run_page_url to xcom.
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DatabricksSubmitRunOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BaseOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply_defaults&lt;/span&gt;
  	&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;......&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;do_xcom_push&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;......&lt;/span&gt;
  	&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;do_xcom_push&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;do_xcom_push&lt;/span&gt;
       
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    	&lt;span class=&quot;n&quot;&gt;hook&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_get_hook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
      &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hook&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run_now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;_handle_databricks_operator_execution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;XCOM_RUN_ID_KEY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'run_id'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;XCOM_RUN_PAGE_URL_KEY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'run_page_url'&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_handle_databricks_operator_execution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hook&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;do_xcom_push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'ti'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xcom_push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;XCOM_RUN_ID_KEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Run submitted with run_id: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;run_page_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hook&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_run_page_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;operator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;do_xcom_push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  	&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'ti'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xcom_push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;XCOM_RUN_PAGE_URL_KEY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run_page_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'View run status, Spark UI, and logs at &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;run_page_url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;do_xcom_push&lt;/code&gt;åœ¨è¿™é‡Œå·²ç»è¢«é»˜è®¤ç½®æˆäº†Falseï¼Œæ˜¯å› ä¸ºOperatorä¸ç¡®å®šå…¶ä»–taskæ˜¯å¦ä¸€å®šéœ€è¦ç›¸å…³å†…å®¹ï¼Œç½®æˆFalseå¯ä»¥ä¸å¾€XComä¼ å¤šä½™çš„ä¸œè¥¿ã€‚å½“taskç”¨Operatoråˆå§‹åŒ–æ—¶æ˜¾ç¤ºæŒ‡å®š&lt;code class=&quot;highlighter-rouge&quot;&gt;do_xcom_push=True&lt;/code&gt;æ—¶ï¼Œåœ¨æ‰§è¡Œæ—¶ä¾¿ä¼šæŠŠ&lt;code class=&quot;highlighter-rouge&quot;&gt;run_id&lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;run_page_url&lt;/code&gt;pushç»™XComï¼Œåé¢çš„taskä¹Ÿå¯ä»¥è¯»åˆ°å¯¹åº”çš„å€¼ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡&lt;code class=&quot;highlighter-rouge&quot;&gt;retrun value&lt;/code&gt;çš„å½¢å¼æ¥å†™å…¥XComï¼Œä¾‹å¦‚&lt;code class=&quot;highlighter-rouge&quot;&gt;SSHOperator&lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;BashOperator&lt;/code&gt;çš„å®ç°ã€‚&lt;em&gt;ï¼ˆBashOperatoråœ¨ä¹‹å‰ç‰ˆæœ¬ä¼ çš„æ˜¯è‡ªå®šä¹‰çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;xcom_push&lt;/code&gt;å‚æ•°æ¥ä½œä¸ºæ ‡å¿—ï¼Œæ–°codeå·²ç»ç»Ÿä¸€æ”¹äº†ã€‚ä½†æˆ‘çœ‹ç°åœ¨airflow masterä¸Šçš„codeï¼Œè¿™ä¸¤ä¸ªoperatoréƒ½æ²¡æœ‰å¯¹do_xcom_pushè¿›è¡Œåˆ¤æ–­ï¼Œè€Œæ˜¯ç›´æ¥retrun valueäº†ã€‚ï¼‰&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;ä¸templateç»“åˆä½¿ç”¨&quot;&gt;ä¸templateç»“åˆä½¿ç”¨&lt;/h3&gt;

&lt;p&gt;ä¸Šé¢æåˆ°çš„XComçš„è·å–éƒ½æ˜¯åœ¨Operatorå†…éƒ¨è°ƒç”¨xcom_pullã€‚é‚£ä¹ˆï¼Œå¦‚æœæˆ‘è¦åœ¨åˆ›å»ºtaskçš„æ—¶å€™å°±è·å¾—è¿™ä¸ªå€¼ä½œä¸ºtaskçš„åˆå§‹å‚æ•°ä¼ é€’è¿›å»ï¼Œæœ‰æ²¡æœ‰å¯èƒ½åŠåˆ°å‘¢ï¼Ÿè¿™åœ¨ç»™ä¸€äº›é¢„å®šä¹‰çš„Operatorä¼ é€’å‚æ•°æ˜¯å°¤å…¶éœ€è¦ã€‚ç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šçš„ã€‚&lt;/p&gt;

&lt;p&gt;æƒ³åœ¨taskå¤–éƒ¨è·å–xcomé‡Œçš„å€¼ï¼Œå¯ä»¥ç”¨templateæ¥å®ç°ï¼Œç»™ä¸ªBashOperatorçš„ä¾‹å­ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;bash_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BashOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'xcom_pull_by_template'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;bash_command&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'echo &quot;{{ ti.xcom_pull(task_ids=&quot;push_task&quot;, key=&quot;push_key&quot;) }}&quot;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä½¿ç”¨template &lt;code class=&quot;highlighter-rouge&quot;&gt;{{ ti.xcom_pull(...) }}&lt;/code&gt;å¯ä»¥è¾¾åˆ°ç›®çš„ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;{{ *** }}&lt;/code&gt;å¿…é¡»åŒ…å«åœ¨å¼•å·å†…æ‰ç”Ÿæ•ˆã€‚ç›´æ¥ä½¿ç”¨æ˜¯ä¼šæŠ¥é”™çš„ã€‚å†çœ‹ä¸‹Airflowä½¿ç”¨çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;jinja template&lt;/code&gt;çš„ä»‹ç»ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;A jinja template is simply a text file that contains the following:&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;variables&lt;/strong&gt; and/or &lt;strong&gt;expressions&lt;/strong&gt; - these get replaced with values when a template is rendered.&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;tags&lt;/strong&gt; - these control the logic of the template.&lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;Jinja templating allows you to defer the rendering of &lt;strong&gt;strings&lt;/strong&gt; in your tasks until the actual running of those tasks.&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;å°±æ˜¯è¯´ï¼Œtemplateåšçš„æ˜¯ç®€å•çš„å­—ç¬¦ä¸²æ›¿æ¢ï¼Œè€Œä¸å…³å¿ƒvalueçš„å®é™…æ•°æ®ç±»å‹ã€‚æ‰€ä»¥ï¼Œå¦‚æœæ˜¯ä½ æƒ³ä¼ çš„æ˜¯æ¯”è¾ƒå¤æ‚çš„æ•°æ®ç±»å‹çš„è¯ï¼Œtemplateæ˜¯ä¸ä¼šå¤„ç†çš„ã€‚è¿™é‡Œï¼Œå»ºè®®å¯ä»¥å¾€XComé‡Œåˆ†åˆ«å¤šæ¬¡pushï¼Œåœ¨å¤–éƒ¨å†æ„é€ æˆéœ€è¦çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œè¦å¾€&lt;code class=&quot;highlighter-rouge&quot;&gt;DatabricksSubmitRunOperator&lt;/code&gt;ä¼ ä¸€ä¸ªjsonç±»å‹çš„å‚æ•°ï¼Œå¯ä»¥è¿™æ ·ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;databricks_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DatabricksSubmitRunOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;databricks_task&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;new_cluster&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;
      &lt;span class=&quot;s&quot;&gt;&quot;node_type_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'{{ ti.xcom_pull(key=&quot;node_type&quot;) }}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;s&quot;&gt;&quot;autoscale&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;&quot;min_workers&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;&quot;max_workers&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'{{ ti.xcom_pull(key=&quot;instance_count&quot;) }}'&lt;/span&gt;
       &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;libraries&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;&quot;jar&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'{{ ti.xcom_pull(key=&quot;jar&quot;) }}'&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;æ€»ç»“&quot;&gt;æ€»ç»“&lt;/h3&gt;

&lt;p&gt;æœ€åï¼Œå¯¹XComçš„ä½¿ç”¨åšä¸‹æ€»ç»“ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;XComç”¨æ¥åœ¨Airflow å„ä¸ªtaské—´è¿›è¡Œæ•°æ®å…±äº«&lt;/li&gt;
  &lt;li&gt;XComé€šè¿‡æŠŠtaskéœ€è¦ä¼ é€’çš„ä¿¡æ¯ä»¥KVçš„å½¢å¼å­˜åˆ°DBä¸­æ¥å®ç°æ•°æ®å…±äº«&lt;/li&gt;
  &lt;li&gt;å¯ä»¥é€šè¿‡TaskInstanceçš„xcom_pushå’Œxcom_pushæ¥å­˜å–æ•°æ®&lt;/li&gt;
  &lt;li&gt;æœ‰äº›é¢„å®šä¹‰çš„Operatoré€šè¿‡do_xcom_pushå˜é‡åˆ¤æ–­æ˜¯å¦å¾€XComå­˜ç»“æœ&lt;/li&gt;
  &lt;li&gt;åœ¨taskå¤–éƒ¨å¯ä»¥é€šè¿‡templateçš„æ–¹å¼è·å–XComé‡Œçš„å€¼&lt;/li&gt;
&lt;/ol&gt;</content><author><name>jessychen</name></author><category term="Airflow" /><category term="CS" /><summary type="html">XComs let tasks exchange messages, allowing more nuanced forms of control and shared state. The name is an abbreviation of â€œcross-communicationâ€.</summary></entry><entry><title type="html">MiniProjä¹‹å¤è¯—è¯æ£€ç´¢</title><link href="https://kiwijia.work/2020/03/31/poem/" rel="alternate" type="text/html" title="MiniProjä¹‹å¤è¯—è¯æ£€ç´¢" /><published>2020-03-31T00:00:00+08:00</published><updated>2020-03-31T00:00:00+08:00</updated><id>https://kiwijia.work/2020/03/31/poem</id><content type="html" xml:base="https://kiwijia.work/2020/03/31/poem/">&lt;blockquote&gt;
  &lt;p&gt;The most comprehensive database of Chinese poetry&lt;/p&gt;

  &lt;p&gt;åŒ…å« 5.5 ä¸‡é¦–å”è¯—ã€26 ä¸‡é¦–å®‹è¯—ã€2.1 ä¸‡é¦–å®‹è¯å’Œå…¶ä»–å¤å…¸æ–‡é›†ã€‚è¯—äººåŒ…æ‹¬å”å®‹ä¸¤æœè¿‘ 1.4 ä¸‡å¤è¯—äººï¼Œå’Œä¸¤å®‹æ—¶æœŸ 1.5 åƒå¤è¯äººã€‚æ­¤æ•°æ®åº“é€šè¿‡ JSON æ ¼å¼åˆ†å‘ï¼Œå¯ä»¥è®©ä½ å¾ˆæ–¹ä¾¿çš„å¼€å§‹ä½ çš„é¡¹ç›®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Githubä¸Šæœ‰ä¸å°‘å®è—é¡¹ç›®ï¼Œæ¯”å¦‚ğŸ‘†è¿™ä¸ªï¼šæœ€å…¨ä¸­åå¤è¯—è¯åº“ - &lt;a href=&quot;https://github.com/chinese-poetry/chinese-poetry&quot;&gt;chinese-poetry&lt;/a&gt;ã€‚å‰å‡ å¤©åŸºäºè¿™ä¸ªå®åº“å†™äº†ä¸ªæ£€ç´¢çš„çš„å°ç¨‹åºï¼Œè¿™é‡Œåšä¸‹å¼€å‘è¿‡ç¨‹çš„è®°å½•ã€‚å®ç°äº†ä¸€ä¸ªç®€å•çš„demo, è§&lt;a href=&quot;/lab/poem.html&quot;&gt;poem&lt;/a&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;#æŠ€æœ¯åˆ†æ&quot;&gt;æŠ€æœ¯åˆ†æ&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#å®ç°&quot;&gt;å®ç°&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;# æ¼”ç¤º&quot;&gt;æ¼”ç¤º&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;# åè®°&quot;&gt;åè®°&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;æŠ€æœ¯åˆ†æ&quot;&gt;æŠ€æœ¯åˆ†æ&lt;/h3&gt;

&lt;p&gt;ä½œä¸ºä¸€å10åã€‚ã€‚ã€‚ã€‚ã€‚ã€‚çš„è€æ¯äº²ï¼Œå­¦æ ¡ç»å¸¸ä¼šç•™ä¸€äº›å¤è¯—è¯èƒŒè¯µçš„ä½œä¸šç»™å­©å­ã€‚å¯æ˜¯ï¼Œä½œä¸ºä¸€åä¸é«˜è€ƒè„±èŠ‚å‡ åå¹´çš„çº¯ç†å·¥ç§‘ç”Ÿï¼Œå¥½å¤šè¯—æˆ‘çœŸæ˜¯è§éƒ½æ²¡è§è¿‡&lt;del&gt;ï¼ˆå…¶å®æ˜¯è¿˜ç»™è€å¸ˆäº†ï¼‰&lt;/del&gt;ã€‚è¿™æ—¶å€™ï¼Œæ€»æ˜¯ç‰¹åˆ«ç¾¡æ…•é‚£äº›å­¦å¯Œäº”è½¦çš„å®¶é•¿ï¼Œå­©å­æé—®æ—¶å„ç§è¯—è¯æ–‡å­¦å…¸æ•…ä¿¡æ‰‹æ‹ˆæ¥ã€‚ä¸åƒæˆ‘ï¼Œåªèƒ½å·´å·´çš„æ±‚åŠ©ç™¾åº¦ï¼Œæœ‰æ—¶å€™è¿˜å‡ºæ¥ä¸€å †ä¸é è°±çš„ç»“æœğŸ˜­ã€‚ä¸è¿‡å¥½åœ¨&lt;strong&gt;çŸ¥è¯†ä¸å¤Ÿï¼ŒæŠ€æœ¯æ¥å‡‘&lt;/strong&gt;ï¼Œåˆšå¥½å‘ç°è¿™ä¹ˆä¸ªè¯—è¯å®åº“ï¼Œæ€èƒ½æš´æ®„å¤©ç‰©å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;æœ‰äº†åŠ¨æ‰‹å†™ä¸€ä¸ªè¯—è¯æ£€ç´¢çš„æƒ³æ³•ï¼Œè‡ªç„¶æ˜¯è¦è¡ŒåŠ¨çš„ã€‚ç«‹åˆ»æŠŠcodeä¸‹åˆ°æœ¬åœ°ï¼Œçœ‹ä¸‹æ•°æ®sizeã€‚å—¯ï¼Œä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œè¿™æ ·è¦æ˜¯è‡ªå·±ç”¨ç”¨çš„è¯ç›´æ¥è§£ææ–‡ä»¶å°±å¯ä»¥äº†ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;100K	./youmengying &lt;span class=&quot;c&quot;&gt;#å¹½æ¢¦å½±&lt;/span&gt;
 15M	./ci  &lt;span class=&quot;c&quot;&gt;#å®‹è¯&lt;/span&gt;
348K	./wudai  &lt;span class=&quot;c&quot;&gt;#äº”ä»£&lt;/span&gt;
143M	./json   &lt;span class=&quot;c&quot;&gt;#å…¨å”è¯—&lt;/span&gt;
172K	./sishuwujing  &lt;span class=&quot;c&quot;&gt;#å››ä¹¦äº”ç»&lt;/span&gt;
 72K	./lunyu   &lt;span class=&quot;c&quot;&gt;#è®ºè¯­&lt;/span&gt;
160K	./shijing  &lt;span class=&quot;c&quot;&gt;#è¯—ç»&lt;/span&gt;
1.0M	./mengxue   &lt;span class=&quot;c&quot;&gt;#è’™å­¦&lt;/span&gt;
4.0M	./yuanqu    &lt;span class=&quot;c&quot;&gt;#å…ƒæ›²&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å†çœ‹ä¸‹ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæ ¹æ®æ•°æ®å¤§å°ï¼Œæœ‰çš„è¢«åˆ‡åˆ†æˆäº†å¤šä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚&lt;code class=&quot;highlighter-rouge&quot;&gt;json&lt;/code&gt;,&lt;code class=&quot;highlighter-rouge&quot;&gt;ci&lt;/code&gt;ï¼Œæœ‰çš„å åœ°ä¸å¤§çš„å°±åªä¿ç•™äº†ä¸€ä¸ªï¼Œä¾‹å¦‚&lt;code class=&quot;highlighter-rouge&quot;&gt;shijing&lt;/code&gt;,&lt;code class=&quot;highlighter-rouge&quot;&gt;yuanqu&lt;/code&gt;ã€‚æ‰“å¼€æ–‡ä»¶çœ‹çœ‹ï¼Œéƒ½æ˜¯æ ‡å‡†çš„jsonæ ¼å¼ï¼Œæ‹¿è¯—ä»™çš„çœ‹çœ‹ï¼Œå…¶ä»–çš„ä¹Ÿå·®ä¸å¤šï¼Œé™¤äº†ä¸åŒç±»å‹æ–‡ä»¶çš„keyå¯èƒ½ä¸åŒå¤–ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æç™½&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;paragraphs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;é›²æƒ³è¡£è£³èŠ±æƒ³å®¹ï¼Œæ˜¥é¢¨æ‹‚æª»éœ²è¯æ¿ƒã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è‹¥éç¾£ç‰å±±é ­è¦‹ï¼Œæœƒå‘ç‘¤è‡ºæœˆä¸‹é€¢ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;tags&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å”è¯—ä¸‰ç™¾é¦–&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å¥³å­&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¹åºœ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;èµç¾&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è¿‘ä»£æ›²è¾&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;é›œæ›²æ­Œè¾­ æ¸…å¹³èª¿ ä¸€&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;b5f1094b-b9be-43cf-8e04-9b984642a630&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å‘ç°æ²¡ï¼Ÿå…¨å”è¯—çš„ç›®å½•ä¸‹æ˜¯ç¹ä½“å­—ï¼Œä½†å…¶å®å¹¶ä¸æ˜¯æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯ç¹ä½“ï¼Œåƒå®‹è¯çš„æ•°æ®ä½œè€…å·²ç»è½¬æˆç®€ä½“äº†ã€‚è‡³äºä¸ºä»€ä¹ˆå…¨å”è¯—ä¿ç•™çš„æ•°æ®è¦æ˜¯ç¹ä½“ï¼Œä½œè€…ç»™å‡ºçš„è§£é‡Šæ˜¯ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ç›®å‰è¿˜æ²¡æœ‰è®¡åˆ’åšç®€ä½“ä¸­æ–‡æ•°æ®åº“ã€‚ä¸€å¯¹ä¸€ç¹ç®€è½¬æ¢æœ‰å¾ˆå¤šå·¥å…·å¯ä»¥åšï¼Œ ç”±äºç®€ä½“å­—çš„åˆ å‡åœ¨æŸäº›è¯—è¯åœºæ™¯ä¸‹é€šè¿‡ä¸€å¯¹ä¸€çš„è½¬æ¢æ˜¯æœ‰é—®é¢˜çš„ã€‚ æ¯”å¦‚â€œå‘è´¢â€ç¹ä½“æ˜¯â€œç™¼è²¡â€ï¼Œè€Œâ€œç†å‘â€ç¹ä½“åº”æ˜¯â€œç†é«®â€. æ›´å¤šçš„äººåä¸å¤ªå®¹æ˜“é¿å…ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ£€æŸ¥å®Œæ–‡ä»¶ï¼Œå†åˆ—ä¸€ä¸‹è¿™æ¬¡çš„éœ€æ±‚ï¼Œå¾ˆç®€å•ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;è¾“å…¥ä¸€ä¸ªæ ‡é¢˜ï¼Œæˆ–è€…ä½œè€…ï¼Œæˆ–è€…é‡Œé¢çš„ä¸€å¥è¯æŠŠå¯¹åº”çš„å†…å®¹ç»™æ£€ç´¢å‡ºæ¥&lt;/li&gt;
  &lt;li&gt;æ£€ç´¢åˆ°å¤šä¸ªåŒ¹é…é¡¹æ—¶ï¼Œä¼˜å…ˆè¿”å›å…¨éƒ¨åŒ¹é…çš„ï¼Œéšåè¿”å›éƒ¨åˆ†åŒ¹é…çš„ï¼Œå¹¶åœ¨æŸ¥è¯¢æ—¶ç»™å®šéœ€è¦æœ€å¤šè¿”å›çš„æ¡æ•°&lt;/li&gt;
  &lt;li&gt;å› ä¸ºæœ‰æ—¶å€™æˆ‘åªæƒ³éšä¾¿çœ‹çœ‹ï¼Œæœ‰éšæœºå–ç¯‡å†…å®¹è¿”å›çš„åŠŸèƒ½&lt;/li&gt;
  &lt;li&gt;ä¸ºäº†å¯¹å°ç›†å‹å‹å¥½ï¼ŒæŠŠè¿”å›çš„æ ¼å¼è½¬æˆç®€ä½“&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;å®ç°&quot;&gt;å®ç°&lt;/h3&gt;

&lt;p&gt;è¿™æ¬¡çš„å®ç°ï¼Œä¾ç„¶é€‰æ‹©äº†pythonï¼ŒåŸå› è‡ªç„¶æ˜¯å› ä¸ºæ–¹(tou)ä¾¿(lan)ã€‚&lt;/p&gt;

&lt;h4 id=&quot;ç¡®å®šæ¥å£&quot;&gt;ç¡®å®šæ¥å£&lt;/h4&gt;

&lt;p&gt;é¦–å…ˆï¼Œè¦å®šä¹‰æ£€ç´¢æ¥å£ã€‚æ ¹æ®éœ€æ±‚ï¼Œèƒ½å¤Ÿå¤šç»´åº¦çš„æ£€ç´¢ï¼Œä½†ä¸åŒç±»å‹æ–‡ä»¶çš„jsonå­—æ®µkeyä¸åŒï¼Œæ‰€ä»¥è‡ªç„¶æƒ³åˆ°ç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;dict&lt;/code&gt;ä½œä¸ºæ£€ç´¢æ¡ä»¶çš„ä¼ é€’&lt;code class=&quot;highlighter-rouge&quot;&gt;index_json&lt;/code&gt;ï¼Œä¹Ÿæ–¹ä¾¿ä»¥åçš„æ‰©å±•ã€‚å¦å¤–æ£€ç´¢å‰æœ€å¥½èƒ½æŒ‡å®šç±»å‹&lt;code class=&quot;highlighter-rouge&quot;&gt;peom_type&lt;/code&gt;ï¼ˆæ˜¯å”è¯—ï¼Œè¿˜æ˜¯å®‹è¯ï¼Œè¿˜æ˜¯è¯—ç»ã€‚ã€‚ã€‚ï¼‰ï¼Œæ£€ç´¢åèƒ½æŒ‡å®šä¸€ä¸ªè¿”å›æ¡ç›®æ•°&lt;code class=&quot;highlighter-rouge&quot;&gt;count&lt;/code&gt;ã€‚å½“ç„¶ï¼Œæœ‰&lt;strong&gt;éšæœºçœ‹çœ‹&lt;/strong&gt;è¿™ç§è®¾å®šçš„å­˜åœ¨ï¼Œè¾“å…¥å‚æ•°è‡ªç„¶ä¸æ˜¯å¿…é¡»çš„ã€‚è¿™æ ·ï¼Œå°±ç¡®å®šäº†å‡½æ•°å®šä¹‰ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;#index is a dict json str, like: '{&quot;author&quot;:&quot;æç™½&quot;, &quot;title&quot;:&quot;é™å¤œæ€&quot;}'
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_poem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index_json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;......&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;è¾“å…¥å¤„ç†&quot;&gt;è¾“å…¥å¤„ç†&lt;/h4&gt;

&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæ˜¯å¯¹è¾“å…¥åšå¤„ç†ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;

&lt;p&gt;æ ¹æ®è¯—è¯ç±»å‹ç”Ÿæˆè·¯å¾„ï¼Œæ²¡æœ‰æŒ‡å®šç±»å‹çš„ç»™éšæœºç¡®å®šä¸€ä¸ª&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;   &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_type_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;poem_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_path_prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç”±äºæŸäº›æ•°æ®æ˜¯ç¹ä½“å­—ï¼ˆå¦‚å…¨å”è¯—ï¼‰ï¼Œåœ¨æ£€ç´¢ç¹ä½“æ•°æ®æ—¶æˆ‘ä»¬è¦å°†è¾“å…¥&lt;code class=&quot;highlighter-rouge&quot;&gt;index_json&lt;/code&gt;è½¬æˆç¹ä½“ã€‚è¿™é‡Œç”¨äº†ä¸ªè½»é‡çº§çš„ç¹ç®€ä½“è½¬æ¢åº“&lt;a href=&quot;https://github.com/skydark/nstools/tree/master/zhtools&quot;&gt;zhtools&lt;/a&gt;ï¼Œåªè¦ä¸¤ä¸ªpythonæ–‡ä»¶ï¼Œå°±èƒ½å®ç°ç®€å•çš„è½¬æ¢ã€‚å¹¶æŠŠè¾“å…¥çš„æ£€ç´¢æ¡ä»¶ç”±&lt;code class=&quot;highlighter-rouge&quot;&gt;str&lt;/code&gt;è½¬æˆ&lt;code class=&quot;highlighter-rouge&quot;&gt;dict&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;    &lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;traditional_data&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index_json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;index_json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index_json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;t&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index_json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index_json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Converter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'zh-han&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;æ•°æ®é¢„å¤„ç†&quot;&gt;æ•°æ®é¢„å¤„ç†&lt;/h4&gt;

&lt;p&gt;åƒå…¨å”è¯—è¿™ç§ç”±äºæ•°æ®é‡å¤§è€Œè¢«åˆ†æˆå¤šä¸ªjsonæ–‡ä»¶çš„ï¼Œå¦‚æœä¼ äº†æ£€ç´¢æ¡ä»¶è¿›æ¥çš„è¯å¯ä»¥å…ˆåšä¸ªç®€å•çš„ç­›é€‰æ¥å‡å°‘loadçš„æ–‡ä»¶æ•°ç›®ï¼Œæ¯•ç«Ÿå¦‚æœéå†æ‰€æœ‰æ¡ç›®æ¥æŸ¥æ‰¾çš„è¯ï¼Œpythonçš„æ•ˆç‡è¿˜æ˜¯æŒºæ„Ÿäººçš„ã€‚è¿™é‡Œè°ƒç”¨äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;grep&lt;/code&gt;æ¥åšç®€å•çš„ç­›é€‰ã€‚åšå®Œè¿™æ­¥åï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;file_list&lt;/code&gt;ï¼Œé‡Œé¢å­˜çš„æ˜¯pythonéœ€è¦loadçš„jsonæ–‡ä»¶åˆ—è¡¨ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;    &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grep_poems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;grep_cmd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;content&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;paragraphs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;grep_cmd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;grep -rl &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;\\\&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\\&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.*&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;grep_cmd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;grep -rl &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subprocess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grep_cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subprocess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PIPE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;listdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;æ£€ç´¢&quot;&gt;æ£€ç´¢&lt;/h4&gt;

&lt;p&gt;åˆ°äº†æœ€é‡è¦çš„æ£€ç´¢è¿™ä¸€æ­¥ï¼Œå…¶å®ç›¸å½“ç®€å•ã€‚å°±æ˜¯éå†è¿™æŠŠjsonæ–‡ä»¶loadè¿›æ¥ï¼Œç„¶åæŒ¨ä¸ªåŒ¹é…ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æ•°æ®æ–‡ä»¶ä¸­æŸäº›å­—æ®µçš„å€¼æ˜¯ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;list&lt;/code&gt;ï¼Œå¦‚&lt;code class=&quot;highlighter-rouge&quot;&gt;content&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;paragraghs&lt;/code&gt;ä¹‹ç±»ï¼Œåœ¨æŸ¥æ‰¾çš„æ—¶å€™å°±ä¸èƒ½ç²—æš´çš„ç›´æ¥æ¯”è¾ƒï¼Œè€Œè¦éå†å»çœ‹ã€‚åŒæ—¶ï¼Œä¸ºäº†åº”å¯¹æ ‡é¢˜æˆ–å†…å®¹åªè®°å¾—å¤§æ¦‚çš„åœºæ™¯ï¼Œå¯¹æ¯ä¸ªæ¡ä»¶è¿˜åšäº†æ¨¡ç³Šæ¯”é…ã€‚ç”±äºèƒ½åŠ›æœ‰é™ï¼Œè¿™é‡Œçš„æ¨¡ç³ŠåŒ¹é…å°±æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;contains&lt;/code&gt;æ“ä½œã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;    &lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;poem_contain_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;endswith&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;.json&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;poems&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;r&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poems&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;poem_contain_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                
&lt;span class=&quot;c1&quot;&gt;#retrun value: 0, no match; 1, contain match; 2, all match
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;is_match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;match_level_final&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;match_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;current_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is_match_str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;match_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_level&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_level&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match_level&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;match_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is_match_str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indexs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;match_level_final&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;match_level_final&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match_level&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match_level_final&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match_level_final&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match_level_final&lt;/span&gt;
  
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;is_match_str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;original&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;original&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;original&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;è¿”å›&quot;&gt;è¿”å›&lt;/h4&gt;

&lt;p&gt;æ£€ç´¢å®Œæˆåï¼Œä¼šå¾—åˆ°&lt;code class=&quot;highlighter-rouge&quot;&gt;poem_list&lt;/code&gt;å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;poem_contain_list&lt;/code&gt;ä¸¤ä¸ªåŒ¹é…çš„listã€‚æœ€åçš„å·¥ä½œå°±æ˜¯æ ¹æ®æŒ‡å®šçš„æ¡æ•°ä»è¿™ä¸¤ä¸ªlisté‡ŒæŒ‰ä¼˜å…ˆçº§åŠ éšæœºå–å¾—éœ€è¦çš„è®°å½•ã€‚ç„¶åçœ‹æƒ…å†µåšä¸ªç¹ä½“åˆ°ç®€ä½“çš„è½¬æ¢ï¼Œæ³¨æ„ä¸‹ç¼–ç çš„é—®é¢˜ï¼Œå°±å¤§åŠŸå‘Šæˆäº†ï¼å…¶ä¸­ï¼Œæ–¹æ³•&lt;code class=&quot;highlighter-rouge&quot;&gt;convertAll&lt;/code&gt;å¯ä»¥å°†&lt;code class=&quot;highlighter-rouge&quot;&gt;str&lt;/code&gt;,&lt;code class=&quot;highlighter-rouge&quot;&gt;dict&lt;/code&gt;,å’Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;list&lt;/code&gt;å¯¹è±¡ä¸­çš„æ±‰å­—åšç¹ç®€è½¬æ¢ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_contain_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_contain_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_contain_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;poem_type&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;traditional_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;convertAll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;poem_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ensure_ascii&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;convertAll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;in_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in_type&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;out_obj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in_type&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out_obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in_type&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out_obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;in obj type is not list or dict: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_obj&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in_obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in_type&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;out_obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convertAll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in_type&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;out_obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;convertAll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_obj&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿”å›çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;out_obj&lt;/code&gt;é‡Œå°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å†…å®¹äº†ğŸ‘&lt;/p&gt;

&lt;h3 id=&quot;æ¼”ç¤º&quot;&gt;æ¼”ç¤º&lt;/h3&gt;

&lt;p&gt;å®Œæˆè¿™ä¹ˆä¸€é¡¹å¤§å·¥ç¨‹å½“ç„¶å°‘ä¸äº†æ¼”(de)ç¤º(se)ä¸€ç•ªã€‚å…ˆè¯•è¯•è¯—ä»™çš„&lt;strong&gt;é™å¤œæ€&lt;/strong&gt;å§ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;python3 poem.py -t &quot;tang&quot; -i '{&quot;title&quot;:&quot;é™å¤œæ€&quot;}'  -c 1&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æç™½&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;paragraphs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ç‰€å‰çœ‹æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¸¾å¤´æœ›å±±æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;tags&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å”è¯—ä¸‰ç™¾é¦–&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ–°ä¹åºœè¾&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ€ä¹¡&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¸­ç§‹&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¸€å¹´çº§ä¸Šå†Œ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æœˆäº®&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;äº”è¨€ç»å¥&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å°å­¦å¤è¯—&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;é™å¤œæ€&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ca2c489a-e433-4c0f-8248-77d354f0665e&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å‘ƒã€‚ã€‚ã€‚æ€ä¹ˆå’Œæƒ³è±¡çš„ä¸å¤ªä¸€æ ·ï¼Ÿï¼Ÿèµ¶ç´§ç½‘ä¸Šå»æŸ¥æŸ¥ï¼Œæ‰çŸ¥é“æœ€æ—©è®°è½½çš„å®‹ä»£ç‰ˆæœ¬ç¡®å®æ˜¯ä¸Šé¢è¿™å››å¥ã€‚ç„¶åç»è¿‡å¹¿å¤§åŠ³åŠ¨äººæ°‘çš„å¤šæ¬¡æ”¹ç¼–ï¼Œå°±æˆäº†ç°åœ¨è¯¾æœ¬é‡Œçš„è¿™ä¸€ç§äº†ğŸ˜‚ã€‚ã€‚ã€‚çœŸæ˜¯åˆé•¿è§è¯†äº†ã€‚&lt;/p&gt;

&lt;p&gt;å†è¯•ä¸€ä¸ªå®‹è¯çœ‹çœ‹å§ï¼Œæ¥ä¸ªç†Ÿæ‚‰çš„ï¼Œä¸œå¡å…ˆç”Ÿçš„&lt;strong&gt;æ°´è°ƒæ­Œå¤´&lt;/strong&gt; &lt;em&gt;ï¼ˆæ³¨æ„ï¼Œå®‹è¯åªæœ‰è¯ç‰Œåï¼Œæ²¡æœ‰æ ‡é¢˜ï¼Œæˆ‘ä»¬è¯¾æœ¬é‡Œçš„æ ‡é¢˜éƒ½æ˜¯åäººåŠ ä¸Šå»çš„ï¼‰&lt;/em&gt;ï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;python3 poem.py -t &quot;song&quot; -i '{&quot;author&quot;:&quot;è‹è½¼&quot;, &quot;rhythmic&quot;:&quot;æ°´è°ƒæ­Œå¤´&quot;}'  -c 10&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è‹è½¼&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;paragraphs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è½æ—¥ç»£å¸˜å·ï¼Œäº­ä¸‹æ°´è¿ç©ºã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;çŸ¥å›ä¸ºæˆ‘ï¼Œæ–°ä½œçª—æˆ·æ¹¿é’çº¢ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;é•¿è®°å¹³å±±å ‚ä¸Šï¼Œæ•æ±Ÿå—çƒŸé›¨ï¼Œæ¸ºæ¸ºæ²¡å­¤é¸¿ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è®¤å¾—é†‰ç¿è¯­ï¼Œå±±è‰²æœ‰æ— ä¸­ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¸€åƒé¡·ï¼Œéƒ½é•œå‡€ï¼Œå€’ç¢§å³°ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å¿½ç„¶æµªèµ·ï¼Œæ€èˆä¸€å¶ç™½å¤´ç¿ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å ªç¬‘å…°å°å…¬å­ï¼Œæœªè§£åº„ç”Ÿå¤©ç±ï¼Œåˆšé“æœ‰é›Œé›„ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¸€ç‚¹æµ©ç„¶æ°”ï¼Œåƒé‡Œå¿«å“‰é£ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;rhythmic&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ°´è°ƒæ­Œå¤´&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è‹è½¼&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;paragraphs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å®‰çŸ³åœ¨ä¸œæµ·ï¼Œä»äº‹é¬“æƒŠç§‹ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¸­å¹´äº²å‹éš¾åˆ«ï¼Œä¸ç«¹ç¼“ç¦»æ„ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¸€æ—¦åŠŸæˆåé‚ï¼Œå‡†æ‹Ÿä¸œè¿˜æµ·é“ï¼Œæ‰¶ç—…å…¥è¥¿å·ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;é›…å¿—å›°è½©å†•ï¼Œé—æ¨å¯„æ²§æ´²ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å²äº‘æš®ï¼Œé¡»æ—©è®¡ï¼Œè¦è¤è£˜ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ•…ä¹¡å½’å»åƒé‡Œï¼Œä½³å¤„è¾„è¿Ÿç•™ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æˆ‘é†‰æ­Œæ—¶å›å’Œï¼Œé†‰å€’é¡»å›æ‰¶æˆ‘ï¼ŒæƒŸé…’å¯å¿˜å¿§ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¸€ä»»åˆ˜ç„å¾·ï¼Œç›¸å¯¹å§é«˜æ¥¼ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;rhythmic&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ°´è°ƒæ­Œå¤´&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è‹è½¼&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;paragraphs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ˜æœˆå‡ æ—¶æœ‰ï¼ŒæŠŠé…’é—®é’å¤©ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¸çŸ¥å¤©ä¸Šå®«é˜™ï¼Œä»Šå¤•æ˜¯ä½•å¹´ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æˆ‘æ¬²ä¹˜é£å½’å»ï¼Œåˆæç¼æ¥¼ç‰å®‡ï¼Œé«˜å¤„ä¸èƒœå¯’ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;èµ·èˆå¼„æ¸…å½±ï¼Œä½•ä¼¼åœ¨äººé—´ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è½¬æœ±é˜ï¼Œä½ç»®æˆ·ï¼Œç…§æ— çœ ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¸åº”æœ‰æ¨ï¼Œä½•äº‹é•¿å‘åˆ«æ—¶åœ†ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;äººæœ‰æ‚²æ¬¢ç¦»åˆï¼Œæœˆæœ‰é˜´æ™´åœ†ç¼ºï¼Œæ­¤äº‹å¤éš¾å…¨ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä½†æ„¿äººé•¿ä¹…ï¼Œåƒé‡Œå…±å©µå¨Ÿã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;rhythmic&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ°´è°ƒæ­Œå¤´&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;tags&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å®‹è¯ä¸‰ç™¾é¦–&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;author&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è‹è½¼&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;paragraphs&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ˜µæ˜µå„¿å¥³è¯­ï¼Œç¯ç«å¤œå¾®æ˜ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ©å†¤å°”æ±æ¥å»ï¼Œå¼¹æŒ‡æ³ªå’Œå£°ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å¿½å˜è½©æ˜‚å‹‡å£«ï¼Œä¸€é¼“å¡«ç„¶ä½œæ°”ï¼Œåƒé‡Œä¸ç•™è¡Œã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;å›é¦–æš®äº‘è¿œï¼Œé£çµ®æ…é’å†¥ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ä¼—ç¦½é‡Œï¼ŒçœŸå½©å‡¤ï¼Œç‹¬ä¸é¸£ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;è·»æ”€å¯¸æ­¥åƒé™©ï¼Œä¸€è½ç™¾å¯»è½»ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;çƒ¦å­æŒ‡é—´é£é›¨ï¼Œç½®æˆ‘è‚ ä¸­å†°ç‚­ï¼Œèµ·åä¸èƒ½å¹³ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ¨æ‰‹ä»å½’å»ï¼Œæ— æ³ªä¸å›å€¾ã€‚&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
	&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;rhythmic&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;æ°´è°ƒæ­Œå¤´&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å“‡ï¼ŒåŸæ¥è‹è½¼å†™è¿‡è¿™ä¹ˆå¤š&lt;strong&gt;æ°´è°ƒæ­Œå¤´&lt;/strong&gt;å‘¢ã€‚å½“ç„¶ç‹è²å”±è¿‡çš„é‚£é¦–æœ€æœ‰åï¼Œé€‰è‡ª&lt;strong&gt;å®‹è¯ä¸‰ç™¾é¦–&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&quot;åè®°&quot;&gt;åè®°&lt;/h3&gt;

&lt;p&gt;å…¶å®ï¼Œé¡¹ç›®ä¸­ç”¨åˆ°çš„è¯—è¯æ–‡ä»¶åªæ˜¯è¿™ä¸ªåº“é‡Œçš„ä¸€éƒ¨åˆ†å†…å®¹ï¼Œå®ƒè¿˜æä¾›äº†è¯—è¯ä½œè€…çš„ç®€ä»‹ï¼Œä¸åŒæ¡ç›®åœ¨å„ä¸ªæœç´¢å¼•æ“ä¸­çš„çƒ­åº¦ï¼Œå…¨å”è¯—çš„å¹³ä»„è¯»éŸ³ï¼Œç­‰ç­‰ã€‚ã€‚ã€‚è¯—è¯æ£€ç´¢åªæ˜¯ä¸ªæœ€åŸºæœ¬çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬è¿˜èƒ½åšçš„æ›´å¤šï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;è¯—è¯å¡«ç©ºè€ƒè¯•ï¼Œé—¯å…³ï¼ŒPKâ€¦â€¦å„ç§å°æ¸¸æˆï¼Œç©ä¸­æŒæ¡ä¼ ç»Ÿæ–‡åŒ–&lt;/li&gt;
  &lt;li&gt;å’Œæ–‡å­—è½¬è¯­éŸ³ç»“åˆèµ·æ¥åšä¸ªè‡ªåŠ¨è¯»è¯—ç¨‹åºï¼ŒæŠŠæ¯å¤©çš„ç¡å‰æ•…äº‹æ”¹æˆç¡å‰è¯»è¯—ï¼Œæ–‡åŒ–ç†é™¶ä»å°åšèµ·&lt;/li&gt;
  &lt;li&gt;è‡ªåŠ¨å†™è¯—AIï¼Œå†™ä½œæ²¡æœ‰çµæ„Ÿæ€ä¹ˆåŠï¼ŸAIåŠ©æ‰‹æ¥å¸®ä½ &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ²¡æœ‰åšä¸åˆ°ï¼Œåªæœ‰æƒ³ä¸åˆ°ğŸ˜œ&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œç›´æ¥è¯»æ–‡ä»¶çš„æ•ˆç‡ä¹Ÿæ˜¯ä¸ªé—®é¢˜ã€‚ä¸è¿‡ä¸ç”¨æ‹…å¿ƒè¿™ä¸ªï¼Œçƒ­å¿ƒç½‘å‹ä¹Ÿå†™äº†æŠŠæ–‡ä»¶å¯¼å…¥æ•°æ®åº“ä¹‹ç±»çš„å·¥å…·ï¼Œä¸Šgithubä¸Šç›´æ¥æ‹¿æ¥ç”¨å°±è¡Œã€‚&lt;/p&gt;

&lt;p&gt;åªæœ‰åç«¯çš„è¯—è¯æ£€ç´¢ç”¨èµ·æ¥è¿˜æ˜¯ä¸æ–¹ä¾¿çš„ï¼Œå›å¤´è¿˜æ˜¯è¦è®°ä¸ª&lt;strong&gt;TODO&lt;/strong&gt;æŠŠæŸ¥è¯¢é¡µé¢è¡¥ä¸Šï¼&lt;/p&gt;

&lt;p&gt;å®Œæ•´ä»£ç ä¼ é€ï¼š&lt;a href=&quot;https://github.com/jessychen1984/MiniProj/tree/master/src/misc/poems&quot;&gt;poem&lt;/a&gt;&lt;/p&gt;</content><author><name>jessychen</name></author><category term="Python" /><category term="CS" /><category term="MiniProj" /><summary type="html">The most comprehensive database of Chinese poetry åŒ…å« 5.5 ä¸‡é¦–å”è¯—ã€26 ä¸‡é¦–å®‹è¯—ã€2.1 ä¸‡é¦–å®‹è¯å’Œå…¶ä»–å¤å…¸æ–‡é›†ã€‚è¯—äººåŒ…æ‹¬å”å®‹ä¸¤æœè¿‘ 1.4 ä¸‡å¤è¯—äººï¼Œå’Œä¸¤å®‹æ—¶æœŸ 1.5 åƒå¤è¯äººã€‚æ­¤æ•°æ®åº“é€šè¿‡ JSON æ ¼å¼åˆ†å‘ï¼Œå¯ä»¥è®©ä½ å¾ˆæ–¹ä¾¿çš„å¼€å§‹ä½ çš„é¡¹ç›®ã€‚</summary></entry><entry><title type="html">é™æ€ç½‘ç«™åˆ©ç”¨SCF+APIè®¿é—®è‡ªå®šä¹‰åç«¯æ¥å£</title><link href="https://kiwijia.work/2020/03/27/api-scf/" rel="alternate" type="text/html" title="é™æ€ç½‘ç«™åˆ©ç”¨SCF+APIè®¿é—®è‡ªå®šä¹‰åç«¯æ¥å£" /><published>2020-03-27T00:00:00+08:00</published><updated>2020-03-27T00:00:00+08:00</updated><id>https://kiwijia.work/2020/03/27/api-scf</id><content type="html" xml:base="https://kiwijia.work/2020/03/27/api-scf/">&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;a href=&quot;https://cloud.tencent.com/act/cps/redirect?redirect=10232&amp;amp;cps_key=a513604ea4a22c6246779fede501e4b6&quot;&gt;äº‘å‡½æ•°&lt;/a&gt;ï¼ˆServerless Cloud Functionï¼ŒSCFï¼‰æ˜¯è…¾è®¯äº‘ä¸ºä¼ä¸šå’Œå¼€å‘è€…ä»¬æä¾›çš„æ— æœåŠ¡å™¨æ‰§è¡Œç¯å¢ƒï¼Œå¸®åŠ©æ‚¨åœ¨æ— éœ€è´­ä¹°å’Œç®¡ç†æœåŠ¡å™¨çš„æƒ…å†µä¸‹è¿è¡Œä»£ç ã€‚&lt;/p&gt;
    &lt;/li&gt;
    &lt;li&gt;
      &lt;p&gt;&lt;a href=&quot;https://cloud.tencent.com/act/cps/redirect?redirect=10285&amp;amp;cps_key=a513604ea4a22c6246779fede501e4b6&quot;&gt;API ç½‘å…³&lt;/a&gt;ï¼ˆAPI Gatewayï¼‰æ˜¯ API æ‰˜ç®¡æœåŠ¡ï¼Œæä¾› API çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒ…æ‹¬åˆ›å»ºã€ç»´æŠ¤ã€å‘å¸ƒã€è¿è¡Œã€ä¸‹çº¿ç­‰ã€‚&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;æŠŠå‰å‡ å¤©ç»™å°Samå†™çš„&lt;a href=&quot;/2020/03/23/calculate-generator/&quot;&gt;å‡ºé¢˜å™¨&lt;/a&gt;ç»™ä»–çœ‹äº†ä¸‹ï¼Œå°å®¶ä¼™ååˆ†å¥½å¥‡ï¼Œéš”ä¸‰å·®äº”çš„å°±è¦æ¥è®©æˆ‘æ¼”ç¤ºä¸€ç•ªğŸ˜&lt;del&gt;è™½ç„¶ä»–å¹¶ä¸åšé¢˜&lt;/del&gt;ã€‚åªæ˜¯æ¯æ¬¡éƒ½è¦æ‹¿æœ¬å‡ºæ¥è¾“å‘½ä»¤ç»™ä»–çœ‹å®åœ¨æœ‰äº›éº»çƒ¦ï¼Œ&lt;del&gt;æˆ‘å°±æ˜¯è¿™ä¹ˆæ‡’ï¼Œ&lt;/del&gt;äºæ˜¯æƒ³ç€èƒ½ä¸èƒ½åŠ ä¸ªå‰ç«¯é¡µé¢è°ƒç”¨ï¼Œç›´æ¥æ‰“å¼€é¡µé¢å°±èƒ½çœ‹åˆ°è¿è¡Œæ•ˆæœï¼š&lt;a href=&quot;/lab/calculator.html&quot;&gt;æ•ˆæœ&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ä½œä¸ºä¸€ä¸ªè¡ŒåŠ¨æ´¾åŠ å±…(yang)å®¶(mao)æ´¾ï¼Œæˆ‘ç›®æ ‡é”å®šäº†ç”¨&lt;strong&gt;SCF+API&lt;/strong&gt;çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨å¾ˆğŸ”¥çš„servelessæ–¹æ¡ˆã€‚æœ€å¤§çš„å¥½å¤„å½“ç„¶æ˜¯ä¸ç”¨å†ä¼ºå€™æœåŠ¡å™¨äº†ï¼Œå°‘äº†å¾ˆå¤šæ­å»ºçš„éº»çƒ¦ã€‚è€Œä¸”è¿™ä¸ªæŒ‰å®é™…ä½¿ç”¨é‡è®¡è´¹ï¼Œå¯¹äº&lt;del&gt;æ²¡ä»€ä¹ˆäººæ¥çš„&lt;/del&gt;å°ç½‘ç«™å†é€‚åˆä¸è¿‡äº†ã€‚&lt;/p&gt;

&lt;p&gt;è¯´å®ŒåºŸè¯ï¼Œä¸‹é¢ä»‹ç»ä¸‹è¦æ€ä¹ˆå®ç°äº†ã€‚é¦–å…ˆï¼Œä½ è¦æœ‰ä¸ª&lt;a href=&quot;https://cloud.tencent.com/act/cps/redirect?redirect=11529&amp;amp;cps_key=a513604ea4a22c6246779fede501e4b6&quot;&gt;è…¾è®¯äº‘&lt;/a&gt;è´¦å·ï¼Œç„¶åå‚è€ƒğŸ‘‡çš„ç®€å•æ­¥éª¤ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;#scf&quot;&gt;åˆ›å»ºäº‘å‡½æ•°SCF&lt;/a&gt;ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#api&quot;&gt;åˆ›å»ºAPI gatewayï¼Œåå°æŒ‡å®šè°ƒç”¨æ­¥éª¤1å»ºå¥½çš„äº‘å‡½æ•°&lt;/a&gt;ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#access&quot;&gt;API gatewayä¸­æ–°å»ºå¯†é’¥ï¼Œä½¿ç”¨è®¡åˆ’ï¼Œå®ç°è®¿é—®æ§åˆ¶å¹¶å‘å¸ƒ&lt;/a&gt;ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#front&quot;&gt;å†™å‰ç«¯é¡µé¢ï¼Œè°ƒç”¨åˆšå†™å¥½çš„API&lt;/a&gt;ã€‚&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#finish&quot;&gt;æµ‹è¯•ï¼Œè§£å†³å„ç§bugï¼Œå¤§åŠŸå‘Šæˆ&lt;/a&gt;ï¼&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;åˆ›å»ºäº‘å‡½æ•°scf&quot;&gt;&lt;a id=&quot;scf&quot;&gt;åˆ›å»ºäº‘å‡½æ•°SCF&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;ç…§ç€è¿™ä¸ªæ–‡æ¡£ &lt;a href=&quot;https://cloud.tencent.com/act/cps/redirect?redirect=11835&amp;amp;cps_key=a513604ea4a22c6246779fede501e4b6&quot;&gt;äº‘å‡½æ•°å¿«é€Ÿå…¥é—¨&lt;/a&gt; æŒ‰é‡Œé¢çš„æ­¥éª¤æ¥åˆ›å»ºè‡ªå·±ä¸šåŠ¡å‡½æ•°ã€‚ç¬¬ä¸€æ¬¡å¯ä»¥é€‰æ‹©ä½¿ç”¨æ§åˆ¶å°åˆ›å»ºå‡½æ•°ï¼Œè¿è¡Œç¯å¢ƒä¸­é€‰æ‹©è‡ªå·±ç†Ÿæ‚‰çš„ç¼–ç¨‹è¯­è¨€ï¼Œå½“å‰æ”¯æŒ&lt;strong&gt;python, php, golang, java, nodejs&lt;/strong&gt;å‡ ç§ï¼Œç„¶åå°±å¯ä»¥åœ¨&lt;strong&gt;å‡½æ•°ä»£ç &lt;/strong&gt;ä¸‹æ„‰å¿«çš„å¼€å§‹äº†ã€‚è¿™é‡Œä»¥è¿è¡Œç¯å¢ƒ&lt;strong&gt;Python3.6&lt;/strong&gt;ä¸ºä¾‹ã€‚é»˜è®¤çš„å…¥å£å‡½æ•°æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;index.main_handler&lt;/code&gt;ï¼Œæœ‰ä¸¤ä¸ªè¾“å…¥å‚æ•°:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;eventï¼šå¯ä»¥è·å–è§¦å‘æºçš„æ¶ˆæ¯ - &lt;strong&gt;ä¸»è¦ç”¨æ¥è·å–ä¼ å…¥å‚æ•°&lt;/strong&gt;ã€‚&lt;/li&gt;
  &lt;li&gt;contextï¼šå¯ä»¥è·å–æœ¬å‡½æ•°çš„ç¯å¢ƒåŠé…ç½®ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¸æ¸…æ¥šå‚æ•°é‡Œæœ‰ä»€ä¹ˆçš„ï¼Œæˆ–æ€ä¹ˆç”¨çš„ï¼Œå¯ä»¥ç›´æ¥æ‰“å°å‡ºæ¥çœ‹çœ‹ï¼Œéƒ½æ˜¯dictç±»å‹ï¼Œä¸€ç›®äº†ç„¶ã€‚å»ºè®®åŠ ä¸Šä¼ å…¥å‚æ•°æ£€æŸ¥å’Œé™åˆ¶ï¼Œæ¯•ç«Ÿæˆ‘ä»¬ä¸çŸ¥é“è°ƒç”¨æ¥å£çš„äººä¼šä¼ äº›ä»€ä¹ˆå¥‡æ€ªçš„ä¸œè¥¿ã€‚è¿”å›ç±»å‹åŒ…è£…æˆjsonæ ¼å¼ï¼Œå¯¹å‰ç«¯è°ƒç”¨æ›´å‹å¥½ã€‚ç»™å‡ºæ”¹å¥½çš„ä»£ç ğŸ‘‡ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;# -*- coding: utf8 -*-
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;json&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main_handler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Received event: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Received context: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;queryString&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;auto_cal_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;limit&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;op_count&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;op_type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;,&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;total&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;auto_cal_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;999&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;exceed max input limit&quot;&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;msg&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Here are today's &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d works, good luck!&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;questions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;op_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; 
                &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;+&quot;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;op_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;op_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; 
                &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
                &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;operator error: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;questions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s=&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;questions&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;questions&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dumps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å†™å®Œcodeåå½“ç„¶ä¸èƒ½å¿˜äº†æœ€é‡è¦çš„&lt;strong&gt;æµ‹è¯•&lt;/strong&gt;å·¥ä½œï¼Œä»£ç è¾“å…¥æ¡†ä¸‹å°±æ˜¯æµ‹è¯•çš„å…¥å£ï¼Œéœ€è¦åˆ›å»ºæµ‹è¯•æ¨¡æ¿ã€‚ç³»ç»Ÿå·²ç»é¢„ç½®äº†å¥½å‡ ç§æ¨¡æ¿ç±»å‹ï¼Œç›´æ¥æ‹¿æ¥æ”¹æˆä½ éœ€è¦çš„å°±å¥½ã€‚æˆ‘ä»¬ç”¨&lt;strong&gt;API Gatewayäº‹ä»¶æ¨¡æ¿&lt;/strong&gt;ä¸ºåŸå‹ä¿®æ”¹åˆšå†™å¥½çš„å‡ºé¢˜å™¨çš„æµ‹è¯•æ¨¡æ¿ã€‚ç”±äºæˆ‘ä»¬codeè·å–çš„æ˜¯eventé‡Œçš„&lt;code class=&quot;highlighter-rouge&quot;&gt;queryString&lt;/code&gt;ï¼Œè¿™é‡Œåªç”¨ä¿®æ”¹é‡Œé¢çš„&lt;code class=&quot;highlighter-rouge&quot;&gt;queryString&lt;/code&gt;è¿™å—ï¼š&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nl&quot;&gt;&quot;queryString&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;op_type&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;+,-&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;op_count&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;limit&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;total&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
 &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åˆ›å»ºå®Œæµ‹è¯•æ¨¡æ¿åï¼Œç‚¹å‡»å·¦ä¾§&lt;strong&gt;æµ‹è¯•&lt;/strong&gt;ï¼Œç¬é—´è¿”å›ç»“æœï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;è¿”å›ç»“æœ
&lt;span class=&quot;s2&quot;&gt;&quot;{&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Here are today's 10 works, good luck!&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;questions&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;: [&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1: 76-4-44=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2: 52-42+67=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3: 95+4-50=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4: 84-78-1=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5: 29-20-9=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6: 19+37+38=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7: 93-53+57=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8: 80+7+7=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9: 90-74-11=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;10: 7+34+52=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;]}&quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç»“æœä¸‹æ–¹è¿˜æœ‰&lt;strong&gt;æ‰§è¡Œæ‘˜è¦&lt;/strong&gt;å’Œ&lt;strong&gt;æ‰§è¡Œæ—¥å¿—&lt;/strong&gt;ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚&lt;/p&gt;

&lt;h3 id=&quot;åˆ›å»ºapi-gateway&quot;&gt;&lt;a id=&quot;api&quot;&gt;åˆ›å»ºAPI gateway&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;äº‘å‡½æ•°SCFå†™å®Œåï¼Œå¦‚æœæƒ³è¦èƒ½é€šè¿‡ç½‘ç»œhttp(s)è¯·æ±‚ç›´æ¥è®¿é—®ï¼Œå°±è¦ä¸ºå…¶æ·»åŠ è§¦å‘æ–¹å¼ä¸º&lt;strong&gt;APIç½‘å…³è§¦å‘å™¨&lt;/strong&gt;ã€‚åŒæ—¶å¼ºçƒˆå»ºè®®å°†é‰´æƒæ–¹æ³•ç½®ä¸º&lt;strong&gt;APIç½‘å…³å¯†é’¥å¯¹&lt;/strong&gt;ã€‚ç„¶åå°±ä¼šåœ¨API gatewayä¸‹è‡ªåŠ¨åˆ›å»ºå‡ºä¸€ä¸ªå¯¹åº”çš„service APIã€‚è¿™ä¸€æ­¥å¦‚æœé‡åˆ°æƒé™é—®é¢˜æ— æ³•è‡ªåŠ¨åˆ›å»ºAPIçš„è¯ï¼Œä¹Ÿä¸è¦ç€æ€¥ï¼Œå¯ä»¥ç›´æ¥åœ¨API gatewayçš„æ§åˆ¶å°æ“ä½œï¼Œå‚è€ƒè¿™é‡Œï¼š&lt;a href=&quot;https://cloud.tencent.com/act/cps/redirect?redirect=11836&amp;amp;cps_key=a513604ea4a22c6246779fede501e4b6&quot;&gt;APIç½‘å…³å¿«é€Ÿå…¥é—¨&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;åˆ›å»ºAPIæ—¶æ³¨æ„å°†é‰´æƒç±»å‹æ”¹æˆ&lt;strong&gt;å¯†é’¥å¯¹&lt;/strong&gt;ã€‚ä¸‹æ–¹æœ‰ä¸ª&lt;strong&gt;æ”¯æŒCORS&lt;/strong&gt;çš„é€‰é¡¹ï¼Œå¦‚æœéœ€è¦è·¨åŸŸè®¿é—®å°±å‹¾ä¸Šï¼Œåä¹‹å¯ä»¥å¿½ç•¥ã€‚è®¾ç½®å®Œéœ€è¦æ¥æ”¶çš„å‚æ•°åï¼Œåœ¨ä¸‹ä¸€æ­¥çš„&lt;strong&gt;åç«¯é…ç½®&lt;/strong&gt;ä¸­é€‰åç«¯ç±»å‹ä¸º&lt;strong&gt;cloud function&lt;/strong&gt;åï¼Œé€‰ä¸­åˆšå»ºå¥½çš„äº‘å‡½æ•°ï¼Œå°±åšå¥½äº†è¿™ä¸¤è€…çš„å…³è”ã€‚&lt;/p&gt;

&lt;p&gt;å»ºå¥½APIåï¼Œæ¥åˆ°å¯¹åº”æœåŠ¡ä¸‹çš„&lt;strong&gt;ç®¡ç†API&lt;/strong&gt;æ ‡ç­¾å°±èƒ½çœ‹åˆ°åˆšå»ºå¥½çš„APIã€‚åœ¨åˆ—è¡¨çš„å³ä¾§æœ‰&lt;strong&gt;è°ƒè¯•&lt;/strong&gt;å…¥å£ï¼Œåƒä¸‡ä¸è¦å¿˜äº†ç‚¹è¿›å»åšä¸‹æµ‹è¯•ã€‚æµ‹è¯•å®Œæˆåï¼Œå†åˆ°æœåŠ¡é¡µå®Œæˆ&lt;strong&gt;å‘å¸ƒ&lt;/strong&gt;ï¼Œè¿™æ ·APIå°±å¯ä»¥è¢«è®¿é—®åˆ°äº†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;è®¿é—®æ§åˆ¶&quot;&gt;&lt;a id=&quot;access&quot;&gt;è®¿é—®æ§åˆ¶&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;ç„¶åï¼Œå°±æ¥åˆ°äº†ç›¸å½“é‡è¦ä½†ä¹Ÿå®¹æ˜“è¢«å¿½ç•¥çš„è®¿é—®æ§åˆ¶è¿™æ­¥ã€‚åœ¨å‰é¢æˆ‘ä»¬å·²ç»é€‰æ‹©äº†&lt;strong&gt;å¯†é’¥å¯¹&lt;/strong&gt;çš„æ–¹å¼ä½œä¸ºé‰´æƒç±»å‹ã€‚è™½ç„¶æœ‰å¯†é’¥æ³„éœ²çš„é£é™©ï¼Œä½†å¯¹äºå°ç½‘ç«™æ¥è¯´è¿™ä¸ªéªŒè¯ä¹Ÿæ˜¯è¶³å¤Ÿäº†ï¼Œè®°å¾—ä¿å­˜å¥½å¯†é’¥å¹¶å®šæœŸä¿®æ”¹å°±å¥½ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶åçš„æ­¥éª¤å°±æ˜¯åˆ›å»ºå¯†é’¥å¯¹ï¼Œåˆ›å»º&lt;strong&gt;ä½¿ç”¨è®¡åˆ’&lt;/strong&gt;ç»‘å®šå¯†é’¥å¯¹ï¼Œå†æŠŠä½¿ç”¨è®¡åˆ’ç»‘å®šæœåŠ¡æˆ–APIã€‚ä¸‹é¢ç›´æ¥ç”©å‡ºæ–‡æ¡£ï¼š&lt;a href=&quot;https://cloud.tencent.com/act/cps/redirect?redirect=11840&amp;amp;cps_key=a513604ea4a22c6246779fede501e4b6&quot;&gt;ä½¿ç”¨è®¡åˆ’&lt;/a&gt;ã€‚ä½¿ç”¨è®¡åˆ’ä¸­é™¤äº†å¯ä»¥ç»‘å®šå¯†é’¥å¯¹ï¼Œè¿˜å¯ä»¥è¿›è¡Œæµé‡æ§åˆ¶ï¼Œå¯æŒ‰éœ€è®¾ç½®ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å‰ç«¯è°ƒç”¨&quot;&gt;&lt;a id=&quot;front&quot;&gt;å‰ç«¯è°ƒç”¨&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;é…ç½®å®Œåç«¯æœåŠ¡åï¼Œè¦è§£å†³çš„å°±æ˜¯è®¿é—®çš„é—®é¢˜äº†ã€‚ç”±äºæ²¡é’±ä¾›æœåŠ¡å™¨ï¼Œç”¨çš„æ˜¯é™æ€é¡µé¢æ‰˜ç®¡çš„æ–¹å¼å»ºçš„ç«™ã€‚å‰ç«¯ç›´æ¥ajaxè®¿é—®APIæ¥è·å–ç»“æœã€‚å‚è€ƒæ–‡æ¡£åœ¨æ­¤ï¼š&lt;a href=&quot;https://cloud.tencent.com/act/cps/redirect?redirect=11837&amp;amp;cps_key=a513604ea4a22c6246779fede501e4b6&quot;&gt;å¯†é’¥å¯¹è®¤è¯&lt;/a&gt;ï¼Œ&lt;a href=&quot;https://cloud.tencent.com/act/cps/redirect?redirect=11838&amp;amp;cps_key=a513604ea4a22c6246779fede501e4b6&quot;&gt;å¦‚ä½•ç”Ÿæˆç­¾å&lt;/a&gt;ï¼ˆé‡Œé¢ç»™å‡ºäº†ç”¨ä¸åŒè¯­è¨€ç”Ÿæˆç­¾åçš„ä¾‹å­ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;ç”±äºæ²¡å†™å‰ç«¯å¥½å¤šå¹´ï¼Œå¯¹å‰ç«¯çš„è®¤çŸ¥è¿˜åœç•™åœ¨jså’Œjqueryé˜¶æ®µï¼Œè¿™é‡Œåªèƒ½ç»™å‡ºæ”¹å¥½çš„jqueryå†™æ³•ã€‚ç”¨çš„æ˜¯&lt;a href=&quot;https://github.com/brix/crypto-js&quot;&gt;crypto-js&lt;/a&gt;åŠ å¯†ã€‚&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c1&quot;&gt;//&amp;lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js&quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getHeader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;nowDate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; 
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dateTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;nowDate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toGMTString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SecretId&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;****&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SecretKey&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;****&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;your_source&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;auth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;hmac id=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SecretId&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, algorithm=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;hmac-sha1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, headers=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;x-date source&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, signature=&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;signStr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;x-date: &lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dateTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;source: &lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CryptoJS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;HmacSHA1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;signStr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SecretKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;CryptoJS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sign&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;auth&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sign&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Source&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;X-Date&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dateTime&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Authorization&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sign&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;header&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getQ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ajax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
		&lt;span class=&quot;na&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;https://xxxx/xx&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;na&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;
			&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;op_count&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;op_type&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;+,-&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
			&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
			&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
		&lt;span class=&quot;na&quot;&gt;dataType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;na&quot;&gt;crossDomain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;na&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getHeader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; 
		&lt;span class=&quot;na&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;errorCode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
				&lt;span class=&quot;c1&quot;&gt;//deal function error: data.errorMessage&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
			&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parseJSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; 
			&lt;span class=&quot;c1&quot;&gt;//show result in page&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
		&lt;span class=&quot;na&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;jqXHR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;textStatus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;errorThrown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
			&lt;span class=&quot;c1&quot;&gt;//deal api error&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœåœ¨å‰é¢åˆ›å»ºAPI gatewayçš„serviceæ—¶å€™æ²¡æœ‰æŒ‡å®šè‡ªå®šä¹‰åŸŸåï¼Œæˆ–æ˜¯è‡ªå®šä¹‰åŸŸåå’Œè°ƒç”¨é¡µé¢çš„åŸŸåä¸æ˜¯åŒä¸€ä¸ªï¼Œå°±ä¼šæ¶‰åŠåˆ°&lt;strong&gt;è·¨åŸŸ&lt;/strong&gt;çš„é—®é¢˜ã€‚è§£å†³è·¨åŸŸé—®é¢˜ä¼ ç»Ÿçš„æ–¹æ³•å¯ä»¥ç”¨&lt;strong&gt;jsonp&lt;/strong&gt;ã€‚ä½†å®ƒæ²¡åŠæ³•åœ¨requestçš„Headeré‡ŒåŠ å‚æ•°ï¼Œä¹Ÿå°±ä¼ ä¸äº†é‰´æƒæ‰€éœ€çš„å­—æ®µã€‚æ‰€ä»¥è¿™é‡Œåªèƒ½ç”¨&lt;strong&gt;CORS&lt;/strong&gt;æ¥è§£å†³è·¨åŸŸï¼š&lt;/p&gt;

&lt;p&gt;å¯¹äºæœåŠ¡ç«¯ï¼Œåªè¦å‰é¢å»ºAPIçš„æ—¶å€™å‹¾é€‰äº†&lt;strong&gt;æ”¯æŒCORS&lt;/strong&gt;é€‰é¡¹ï¼Œå°±ä¼šè‡ªåŠ¨å¼€å¯ï¼Œå‚è€ƒ&lt;a href=&quot;https://cloud.tencent.com/act/cps/redirect?redirect=11839&amp;amp;cps_key=a513604ea4a22c6246779fede501e4b6&quot;&gt;APIæ§åˆ¶å°ç›¸å…³é—®é¢˜&lt;/a&gt; ã€‚å¯¹äºå®¢æˆ·ç«¯ï¼Œåœ¨ajaxå‚æ•°ä¸­è®¾ç½®&lt;code class=&quot;highlighter-rouge&quot;&gt;crossDomain: true&lt;/code&gt;å°±å¯ä»¥äº†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å®Œæˆ&quot;&gt;&lt;a id=&quot;finish&quot;&gt;å®Œæˆ&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;æœ€åï¼Œè§£å†³ä¸€ä¸‹é¡µé¢ä¸Šçš„bugï¼Œæµ‹è¯•é€šè¿‡åå°±å¤§åŠŸå‘Šæˆäº†ï¼å†ç»™ä¸€æ¬¡æ¼”ç¤ºåœ°å€ï¼š&lt;a href=&quot;/lab/calculator.html&quot;&gt;æ•ˆæœ&lt;/a&gt;ï¼Œè¿˜åŠ ä¸Šäº†æ‰“å°åŠŸèƒ½ï¼Œä¸ç”¨å†å¤åˆ¶ç²˜è´´äº†ğŸ˜€&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/MiniProj/calculator.gif&quot; alt=&quot;calculator&quot; /&gt;&lt;/p&gt;</content><author><name>jessychen</name></author><category term="Cloud" /><category term="CS" /><summary type="html">äº‘å‡½æ•°ï¼ˆServerless Cloud Functionï¼ŒSCFï¼‰æ˜¯è…¾è®¯äº‘ä¸ºä¼ä¸šå’Œå¼€å‘è€…ä»¬æä¾›çš„æ— æœåŠ¡å™¨æ‰§è¡Œç¯å¢ƒï¼Œå¸®åŠ©æ‚¨åœ¨æ— éœ€è´­ä¹°å’Œç®¡ç†æœåŠ¡å™¨çš„æƒ…å†µä¸‹è¿è¡Œä»£ç ã€‚ API ç½‘å…³ï¼ˆAPI Gatewayï¼‰æ˜¯ API æ‰˜ç®¡æœåŠ¡ï¼Œæä¾› API çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒ…æ‹¬åˆ›å»ºã€ç»´æŠ¤ã€å‘å¸ƒã€è¿è¡Œã€ä¸‹çº¿ç­‰ã€‚</summary></entry><entry><title type="html">å›´æ£‹ç›²å¦‚ä½•æ•™å°å­©ä¸‹æ£‹</title><link href="https://kiwijia.work/2020/03/24/sabaki-go/" rel="alternate" type="text/html" title="å›´æ£‹ç›²å¦‚ä½•æ•™å°å­©ä¸‹æ£‹" /><published>2020-03-24T00:00:00+08:00</published><updated>2020-03-24T00:00:00+08:00</updated><id>https://kiwijia.work/2020/03/24/sabaki-go</id><content type="html" xml:base="https://kiwijia.work/2020/03/24/sabaki-go/">&lt;blockquote&gt;
  &lt;p&gt;Sabaki: An elegant Go board and SGF editor for a more civilized age.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä¸ºäº†é”»ç‚¼æ€ç»´ï¼Œé™¶å†¶æ€§æƒ…ï¼Œæé«˜ç´ è´¨ ã€‚ã€‚ã€‚å¹´å‰å°±ç»™å°SamæŠ¥äº†ä¸ªå›´æ£‹è¯¾&lt;del&gt;ï¼Œè™½ç„¶å®¶é‡Œå¹¶æ²¡æœ‰äººæ‡‚è¿™ä¸ª&lt;/del&gt;ã€‚å¯æƒœç”±äºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œæ˜¥å¤©æ¥äº†å´è¿Ÿè¿Ÿä¸èƒ½å¼€è¯¾ã€‚å¯æ˜¯ï¼Œåœè¯¾ä¸èƒ½åœå­¦å‘€ã€‚äºæ˜¯ï¼Œè€å¸ˆæ‹‰äº†ä¸ªç¾¤ï¼Œç”©å‡ºå‡ ä¸ªæ£‹è°±ï¼Œè¦æ±‚åœ¨å®¶å…ˆå¯è’™ä¸€ä¸‹ï¼Œä¸€çœ‹æ ¼å¼ï¼š&lt;code class=&quot;highlighter-rouge&quot;&gt;xxx.sgf&lt;/code&gt;ï¼Œè¿™ä¸ªæ€ä¹ˆçœ‹å‘€ï¼Ÿï¼Ÿï¼Ÿ&lt;/p&gt;

&lt;p&gt;:woman:ï¼š è€å¸ˆï¼Œé‚£ä¸ªsgfæˆ‘è¦æ€ä¹ˆæ‰“å¼€å‘€ï¼Ÿ
:man:ï¼šç®€å•ï¼Œä½ ä¸‹ä¸ª &lt;del&gt;çŒ«è¸¢ç‹—&lt;/del&gt; multigoå°±å¯ä»¥äº†ã€‚
:woman:ï¼šok~&lt;/p&gt;

&lt;p&gt;ç„¶è€Œã€‚ã€‚ã€‚ä¸ºå•¥æ²¡æœ‰macç‰ˆï¼Ÿï¼Ÿï¼Ÿä¸è¿‡éš¾ä¸å€’æˆ‘ï¼Œè®©googleå¤§ç¥ç»™å’±æ¨èä¸€ä¸ªğŸ˜~&lt;/p&gt;

&lt;p&gt;ç»è¿‡ä¸€ä¸Šåˆçš„æ¯”è¾ƒï¼Œç»ˆäºæ‰¾åˆ°ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§ï¼Œç•Œé¢ç¾è§‚çš„åœ¨macä¸‹çš„å›´æ£‹è½¯ä»¶ï¼š&lt;a href=&quot;https://sabaki.yichuanshen.de/&quot;&gt;sabaki&lt;/a&gt;ã€‚è¿™æ¬¾è½¯ä»¶å®Œå…¨ä½¿ç”¨ç½‘é¡µæŠ€æœ¯(HTML5 + Javascript)å¼€å‘ï¼Œç”±electronå°è£…æˆåº”ç”¨ç¨‹åºï¼Œæœ€æœ€é‡è¦çš„æ˜¯ï¼Œå®ƒè¿˜æ˜¯å¼€æºçš„â€¼ï¸é™„ä¸Š&lt;a href=&quot;https://github.com/SabakiHQ/Sabaki&quot;&gt;gitåœ°å€&lt;/a&gt;ï¼Œä½œè€…è´´å¿ƒçš„ç»™å‡ºäº†æ‰“åŒ…å¥½çš„ç‰ˆæœ¬ï¼š&lt;a href=&quot;https://github.com/SabakiHQ/Sabaki/releases/&quot;&gt;release&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ç›´æ¥å®‰è£…æ‰“åŒ…å¥½çš„ç‰ˆæœ¬ï¼Œéšæ„æ‰“å¼€ä¸ªsgfï¼Œæ¥æ„Ÿå—ä¸€ä¸‹ğŸ‘‡ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/Other/sabaki1.gif&quot; alt=&quot;image-20200324184157994&quot; /&gt;&lt;/p&gt;

&lt;p&gt;åªè¦æŒ‰é”®ç›˜â†‘â†“é”®å°±å¯æŸ¥çœ‹æ¯æ­¥æ£‹çš„è½å­æ­¥éª¤åŠè§£è¯´ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Ÿå¬è€å¸ˆè¯´ä»–ä»¬å°æ—¶å€™å­¦æ£‹è¿˜è¦æ‰‹æŠ„æ£‹è°±ï¼Œæ„Ÿæ…¨ç°åœ¨çš„å°ç›†å‹çœŸæ˜¯å¤ªå¹¸ç¦äº†ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰äº†sabakiï¼ŒåŠ ä¸Šç½‘ä¸Šæ‰¾çš„ä¸€å †å…¥é—¨å›´æ£‹é¢˜ï¼ˆå½“ç„¶éƒ½æ˜¯sgfæ ¼å¼çš„ï¼Œå¸¦è§£è¯´ï¼‰ï¼Œåœ¨å®¶åšå›´æ£‹å¯è’™ä¸è¦å¤ªæ–¹ä¾¿å•Šï¼ æƒ³åˆ°ä¹‹å‰æ‰‹æœºä¸Šä¸‹çš„ä¸€äº›å›´æ£‹å…¥é—¨appï¼Œæœ‰çš„åšå‡ é¢˜å°±è¦æ”¶è´¹ï¼Œæœ‰çš„çœ‹ç­”æ¡ˆè¦æ”¶è´¹ï¼Œæœ‰çš„ä¸€å †çš„å¹¿å‘Šï¼Œæœ‰çš„ä¸å¸¦è§£è¯´ï¼Œè¿™ä¸ªçœŸæ˜¯å¤ªé€‚åˆæˆ‘ç§çˆ±åŠ¨(kou)æ‰‹(men)çš„å°ä¼™ä¼´äº†:&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œsabakiçš„åŠŸèƒ½è¿œè¿œä¸æ­¢è¿™äº›ï¼Œå®ƒçš„æœ€å¼ºå¤§ä¹‹å¤„æ˜¯å¯ä»¥è‡ªå®šä¹‰åç«¯çš„å›´æ£‹å¼•æ“ï¼Œå¯ä»¥ä½œä¸ºå¤šç§å›´æ£‹çš„å‰ç«¯å±•ç°ã€‚å½“ç„¶ï¼Œå¯¹äºæˆ‘ä»¬å®¶è¿™ç§å›´æ£‹å°ç™½æ¥è¯´ï¼Œå®ƒçš„å›¾è°±åŠŸèƒ½å·²ç»å®Œå…¨èƒ½æ»¡è¶³éœ€æ±‚äº†ã€‚è¿™é‡Œç»™å‡ºå®˜ç½‘åˆ—å‡ºçš„åŸºæœ¬åŠŸèƒ½ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;SGF editing tools&lt;/li&gt;
    &lt;li&gt;Intelligent scoring tool&lt;/li&gt;
    &lt;li&gt;Game tree&lt;/li&gt;
    &lt;li&gt;Fuzzy stone placement&lt;/li&gt;
    &lt;li&gt;GTP Engines&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;æœ‰ä¸å°‘å›´æ£‹é«˜æ‰‹ä¼šç”¨sabakié…ç½®å›´æ£‹AIå¼•æ“&lt;a href=&quot;https://github.com/leela-zero/leela-zero&quot;&gt;Leela Zero&lt;/a&gt;æ¥å®ç°äººæœºå¤§æˆ˜ã€‚ç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘æ•™ç¨‹ã€‚åŠ å…¥äº†Leelaçš„sabakiä¸ä½†èƒ½é™ªä½ ä¸‹æ£‹ï¼Œè¿˜èƒ½åˆ†ææ£‹å±€ï¼Œè®¡ç®—å‡ºæ¯æ­¥æ£‹çš„èƒœç‡ã€‚ä¸è¿‡è¿™ä¸ªLeelaä¸‹æ£‹å®åœ¨å¤ªè¿‡å‰å®³ï¼Œå¯¹æ™®é€šäººæ¥è¯´è¿˜æ˜¯ä¸è¦æ‰¾è™çš„å¥½ğŸ˜‚&lt;/p&gt;</content><author><name>jessychen</name></author><category term="other" /><summary type="html">Sabaki: An elegant Go board and SGF editor for a more civilized age.</summary></entry><entry><title type="html">MiniProjä¹‹ç®€å•è®¡ç®—é¢˜å‡ºé¢˜å™¨</title><link href="https://kiwijia.work/2020/03/23/calculate-generator/" rel="alternate" type="text/html" title="MiniProjä¹‹ç®€å•è®¡ç®—é¢˜å‡ºé¢˜å™¨" /><published>2020-03-23T00:00:00+08:00</published><updated>2020-03-23T00:00:00+08:00</updated><id>https://kiwijia.work/2020/03/23/calculate-generator</id><content type="html" xml:base="https://kiwijia.work/2020/03/23/calculate-generator/">&lt;p&gt;æœ€è¿‘ï¼Œå®¶æœ‰å°å„¿åˆé•¿æˆã€‚æ›¾ç»èŒèŒå“’çš„Samå°ç›†å‹ä¹Ÿé©¬ä¸Šè¦æ­¥å…¥å°å­¦ç”Ÿçš„è¡Œåˆ—äº†ã€‚ä¸ºäº†ä¸è¾“åœ¨èµ·è·‘çº¿ä¸Šï¼Œè€æ¯äº²å†³å®šæ¯å¤©ç»™å‡º100é¢˜è®¡ç®—é¢˜ğŸ˜ã€‚æ‰‹åŠ¨å‡ºé¢˜å¤ªéº»çƒ¦ï¼Œè‚¿ä¹ˆåŠï¼Ÿå½“ç„¶æ˜¯åŠ¨æ‰‹å†™ä¸€ä¸ªäº†ï¼ç”¨ä¸Šä¼Ÿå¤§çš„&lt;strong&gt;Python&lt;/strong&gt;ï¼Œåˆ†åˆ†é’Ÿæå®šä¸åœ¨è¯ä¸‹ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;s&quot;&gt;'''
A simple python calculation question generator
usg: python calculator.py -d &quot;+,-&quot; -c 3 -l 200 -t 30
usg: python calculator.py --op_type=&quot;+,-&quot; --op_count=3 --limit=20 --total=30
'''&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;auto_cal_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Here are today's &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d works, good luck!&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;op_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; 
                &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;+&quot;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;op_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;op_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; 
                &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
                &lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;operator error: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;d: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s=&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;question&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_dummy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getopt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getopt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;l:c:d:t:&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;limit=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;op_count=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;op_type=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;total=&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;op_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;op_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;+&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arg&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-l&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;--limit&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;--op_count&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;op_count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;--op_type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;op_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;,&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opt&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-t&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;--total&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;auto_cal_generator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op_count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;op_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'__main__'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æœ‰äº†è¿™ä¸ªç¥å™¨åï¼Œæƒ³çœ‹ç”µè§†ï¼Ÿæƒ³åƒå†°æ¿€å‡Œï¼Ÿæƒ³å»æ¸¸ä¹å›­ï¼Ÿå…ˆåš30é¢˜è§£é”ï¼Œç”¨æ³•ï¼š&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c&quot;&gt;#å‡º30é¢˜200ä»¥å†…3ä¸ªè¿ç®—ç¬¦çš„åŠ å‡æ³•è®¡ç®—&lt;/span&gt;
python calculator.py &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;+,-&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 3 &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; 200 &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 30
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;çœ‹çœ‹ç»“æœï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/MiniProj/auto_cal_q.png&quot; alt=&quot;auto_cal_q&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œå¯¹äºä¸åˆ°ä¸€å¹´çº§çš„å°è±†åŒ…æ¥è¯´ï¼Œç”¨åŠ å‡æ³•å¯¹ä»˜å·²ç»æˆ³æˆ³æœ‰ä½™äº†ï¼Œä¹˜é™¤æ³•ç­‰æœ‰ç©ºå†åŠ å§ã€‚&lt;/p&gt;

&lt;p&gt;é¡¹ç›®ä»£ç &lt;a href=&quot;https://github.com/jessychen1984/MiniProj/blob/master/src/misc/calculator.py&quot;&gt;ç‚¹æ­¤&lt;/a&gt;ä¸‹è½½&lt;/p&gt;

&lt;p&gt;æœ‰ç©ºåˆåŠ äº†ä¸ªåœ¨çº¿æ¼”ç¤ºï¼š&lt;a href=&quot;/lab/calculator.html&quot;&gt;Calculator&lt;/a&gt; ã€‚æ”¯æŒç›´æ¥åœ¨é¡µé¢åšé¢˜ï¼Œä¹Ÿå¯æ‰“å°å‡ºæ¥ã€‚&lt;/p&gt;

&lt;p&gt;æ‡’å¾—åˆ¤é¢˜æ€ä¹ˆåŠï¼Ÿæ¨èï¼š&lt;strong&gt;å­¦è€Œæ€åŸ¹ä¼˜APP -&amp;gt; å‘ç° -&amp;gt; æ™ºèƒ½åˆ¤é¢˜&lt;/strong&gt; ã€‚ æœç„¶ï¼Œæ‡’æƒ°æ˜¯ä¿ƒè¿›äººç±»å‘å±•çš„ç¬¬ä¸€ç”Ÿäº§åŠ›:laughing:&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰ä¸‹è½½ï¼Œä½œä¸ºä¸­å›½äº¿ä¸‡ç„¦è™‘å¦ˆå¦ˆçš„å¿…å¤‡APPï¼Œä½ ä¹Ÿä¸€å®šè¦ä¸‹ä¸€ä¸ªï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/MiniProj/xes.png&quot; alt=&quot;xes&quot; /&gt;&lt;/p&gt;</content><author><name>jessychen</name></author><category term="Python" /><category term="CS" /><category term="MiniProj" /><summary type="html">æœ€è¿‘ï¼Œå®¶æœ‰å°å„¿åˆé•¿æˆã€‚æ›¾ç»èŒèŒå“’çš„Samå°ç›†å‹ä¹Ÿé©¬ä¸Šè¦æ­¥å…¥å°å­¦ç”Ÿçš„è¡Œåˆ—äº†ã€‚ä¸ºäº†ä¸è¾“åœ¨èµ·è·‘çº¿ä¸Šï¼Œè€æ¯äº²å†³å®šæ¯å¤©ç»™å‡º100é¢˜è®¡ç®—é¢˜ğŸ˜ã€‚æ‰‹åŠ¨å‡ºé¢˜å¤ªéº»çƒ¦ï¼Œè‚¿ä¹ˆåŠï¼Ÿå½“ç„¶æ˜¯åŠ¨æ‰‹å†™ä¸€ä¸ªäº†ï¼ç”¨ä¸Šä¼Ÿå¤§çš„Pythonï¼Œåˆ†åˆ†é’Ÿæå®šä¸åœ¨è¯ä¸‹ï¼š</summary></entry><entry><title type="html">Airflowä¸­çš„è·¯å¾„é€‰æ‹©</title><link href="https://kiwijia.work/2020/03/22/python-branch/" rel="alternate" type="text/html" title="Airflowä¸­çš„è·¯å¾„é€‰æ‹©" /><published>2020-03-22T00:00:00+08:00</published><updated>2020-03-22T00:00:00+08:00</updated><id>https://kiwijia.work/2020/03/22/python-branch</id><content type="html" xml:base="https://kiwijia.work/2020/03/22/python-branch/">&lt;blockquote&gt;
  &lt;p&gt;Airflow æ˜¯ Airbnb å…¬å¸å¼€æºçš„ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ, é€šè¿‡ä½¿ç”¨ Python å¼€å‘ DAG, éå¸¸æ–¹ä¾¿çš„è°ƒåº¦è®¡ç®—ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Airflowä¹‹å‰ï¼Œå½“å¤šä¸ªä¸Šä¸‹æ¸¸çš„ä»»åŠ¡é—´å­˜åœ¨ä¾èµ–æ—¶ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ¥å†™ä¸€äº›è°ƒåº¦çš„codeï¼Œå¸¸ç”¨çš„æœ‰å‡ ç§ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ä¸Šæ¸¸ä»»åŠ¡å®Œæˆåç½®ä¸ªdoneæ ‡è®°ã€‚éœ€è¦ä¸‹æ¸¸éš”æ®µæ—¶é—´æ£€æŸ¥ä¸Šæ¸¸ä»»åŠ¡æœ‰æ²¡æœ‰å®Œæˆã€‚&lt;/li&gt;
  &lt;li&gt;ä¸Šæ¸¸å®Œæˆä»»åŠ¡åé€šè¿‡æŸä¸ªapiæ¥callä¸‹æ¸¸ã€‚ä½ è¯´call å¤±è´¥äº†ï¼Ÿretryå¤§æ³•ç”¨èµ·æ¥å‘€â€‹â€‹ã€‚ã€‚ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ¨¡å—å¤ªå¤šï¼Œä¾èµ–å¤ªå¤æ‚ï¼Œè®°ä¸ä½æ€ä¹ˆåŠï¼Ÿå†™ä¸ªæ–‡æ¡£å§ã€‚ã€‚ã€‚ä¸Šæ¸¸æ”¹äº†ï¼Ÿï¼Ÿæ”¹æ–‡æ¡£å§ã€‚ã€‚ã€‚ä¸‹æ¸¸åˆå˜äº†ï¼Ÿï¼Ÿï¼Ÿå†æ”¹ã€‚ã€‚ã€‚å“å‘€ï¼Œä¸Šçº¿æ¥ä¸åŠäº†ï¼Œè¿‡å‡ å¤©æ›´æ–°å§ã€‚ã€‚ã€‚ã€‚é‚£ä¸ªæ–‡æ¡£å¾ˆä¹…æ²¡æ›´æ–°äº†ï¼Œè¿˜æ˜¯çœ‹codeå§ã€‚ã€‚ã€‚&lt;/p&gt;

&lt;p&gt;è€ŒAirflowä½¿ç”¨DAGï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„é€šè¿‡å®šä¹‰&lt;strong&gt;Operator&lt;/strong&gt;ï¼ŒåŠOperatoré—´çš„å…³ç³»ï¼ˆ&lt;strong&gt;upstream, downstream&lt;/strong&gt;ï¼‰æ¥è§£å†³ä»»åŠ¡ä¹‹é—´çš„å„ç§ä¾èµ–ã€‚åŒæ—¶ï¼Œå®ƒè¿˜æä¾›äº†UIæ¥æŸ¥çœ‹ä»»åŠ¡ä¾èµ–çš„DAGï¼Œä»»åŠ¡è¿è¡ŒçŠ¶æ€ã€‚ç®€å•çš„è¯´ï¼Œå®ƒå¯ä»¥ä½¿æˆ‘ä»¬æ›´å¤šçš„å…³æ³¨åˆ°ä¸šåŠ¡çš„å®ç°ä¸Šè€Œä¸æ˜¯å„ç§å¤æ‚çš„æ¨¡å—è°ƒç”¨åŠç¹ççš„æ–‡æ¡£ç»´æŠ¤ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œä½œä¸ºä¸€æ¡å®Œæ•´çš„ä¸šåŠ¡æµï¼Œæ ¹æ®ä¸Šæ¸¸çš„æ‰§è¡Œç»“æœæ¥å†³å®šä¸‹æ¸¸çš„è¡Œä¸ºæ˜¯æœ€å¸¸è§ä¸è¿‡çš„äº‹äº†ã€‚æ¯”å¦‚ğŸ‘‡çš„ä¾‹å­ï¼š&lt;/p&gt;

&lt;p&gt;æœ‰ä¸ªæ·˜æ°”çš„Samå°ç›†å‹ï¼Œæ¯å¤©æŒ‰æ—¶ &lt;strong&gt;å®Œæˆä½œä¸š&lt;/strong&gt; æ˜¯ä¸ªå¤§éš¾é¢˜ã€‚äºæ˜¯ï¼Œå¦ˆå¦ˆæƒ³äº†ä¸ªåŠæ³•ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/in-post/Airflow/branch.png&quot; alt=&quot;branch-dag&quot; /&gt;&lt;/p&gt;

&lt;p&gt;çœŸæ˜¯ä¸ªä¸é”™çš„æ³•å­ğŸ‘ï¼è¿™é‡Œï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;8ç‚¹å‰å†™å®Œ&lt;/code&gt;åœ¨Airflowé‡Œå°±æ˜¯ä¸ªåˆ¤æ–­ç”¨çš„taskï¼Œç”±å®ƒæ¥å†³å®šæ•´ä¸ªDAGçš„ä¸‹ä¸€æ­¥æ“ä½œã€‚é‚£ä¹ˆï¼Œæ€ä¹ˆå®ç°å‘¢ï¼ŸAirflowæä¾›äº†&lt;strong&gt;BranchPythonOperator&lt;/strong&gt;ï¼Œç”¨æ¥æ”¯æŒåˆ†æ”¯, é€šè¿‡å‡½æ•°è¿”å›è¦æ‰§è¡Œçš„åˆ†æ”¯ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;check_hour_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BranchPythonOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;check_hour&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;python_callable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;check_hour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;check_hour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;current_hour&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;sleep&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;watch_animation&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;do_homework_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;check_hour_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;watch_animation_op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sleep_op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;watch_animation_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sleep_op&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;OkğŸ‘ ç®€ç›´å¤ªç®€å•äº†ï¼æ‰§è¡Œä¸€ä¸‹è¯•è¯•ï¼Œç„¶åä½ ä¼šå‘ç°ï¼Œå½“&lt;code class=&quot;highlighter-rouge&quot;&gt;check_hour&lt;/code&gt;è¿”å›&lt;code class=&quot;highlighter-rouge&quot;&gt;watch_animation&lt;/code&gt;æ—¶ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;sleep&lt;/code&gt;è¿™ä¸ªtaskçš„çŠ¶æ€æ°¸è¿œæ˜¯skipçš„ï¼Ÿï¼Ÿï¼Ÿè®©æˆ‘ä»¬ç¿»ä¸€ä¸‹å®˜æ–¹çš„è§£é‡Šï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Note that using tasks with &lt;code class=&quot;highlighter-rouge&quot;&gt;depends_on_past=True&lt;/code&gt; downstream from &lt;code class=&quot;highlighter-rouge&quot;&gt;BranchPythonOperator&lt;/code&gt; is logically unsound as &lt;code class=&quot;highlighter-rouge&quot;&gt;skipped&lt;/code&gt; status will invariably lead to block tasks that depend on their past successes. &lt;code class=&quot;highlighter-rouge&quot;&gt;skipped&lt;/code&gt; states propagates where all directly upstream tasks are &lt;code class=&quot;highlighter-rouge&quot;&gt;skipped&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å°±æ˜¯è¯´ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;sleep&lt;/code&gt;è¿™ä¸ªtaskåœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;check_hour&lt;/code&gt;é€‰æ‹©äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;watch_animation&lt;/code&gt;çš„æ—¶å€™å°±è¢«skipæ‰äº†ï¼Œå³ä¾¿è¿™é‡Œå®ƒæ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;watch_animation&lt;/code&gt;çš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œä»ç„¶ä¸ä¼šè¢«æ‰§è¡ŒğŸ˜­ã€‚åŸå› å‘¢ï¼Ÿå®˜æ–¹è¯´æ˜¯downstreamè®¾äº†&lt;em&gt;depends_on_past=True&lt;/em&gt;ã€‚è¦çŸ¥é“ï¼Œoperatorä¸­è¿˜æœ‰ä¸ªå±æ€§å«&lt;em&gt;trigger_rule&lt;/em&gt;ï¼Œé»˜è®¤å€¼æ˜¯&lt;em&gt;all_success&lt;/em&gt;ã€‚è¿™ä¸¤ä¸ªç»„åˆåœ¨ä¸€èµ·å°±è¦ä¸Šæ¸¸çš„taskçŠ¶æ€éƒ½ä¸º&lt;em&gt;success&lt;/em&gt;æ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚è€Œè¿™é‡Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;sleep&lt;/code&gt;çš„ä¸Šæ¸¸ä»»åŠ¡&lt;code class=&quot;highlighter-rouge&quot;&gt;watch_animation&lt;/code&gt;çŠ¶æ€æ˜¯&lt;em&gt;skipped&lt;/em&gt;, æ‰€ä»¥&lt;code class=&quot;highlighter-rouge&quot;&gt;sleep&lt;/code&gt;å°±æ²¡æœ‰è¢«æ‰§è¡Œåˆ°äº†ã€‚é‚£ä¹ˆï¼Œå¦‚æœè¿™é‡Œæˆ‘ä»¬æŠŠ&lt;code class=&quot;highlighter-rouge&quot;&gt;sleep&lt;/code&gt;çš„&lt;em&gt;trigger_rule&lt;/em&gt;ç½®æˆ&lt;em&gt;none_failed&lt;/em&gt;çš„è¯ï¼Œæ•´ä¸ªè¿‡ç¨‹å°±èƒ½æŒ‰æˆ‘ä»¬é¢„æœŸçš„æ‰§è¡Œä¸‹å»äº†:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;sleep_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PythonOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;sleep&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;trigger_rule&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;none_failed&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;python_callable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;sleep&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å†è¯•ä¸€ä¸‹ï¼Œæœç„¶å¯ä»¥å•¦:satisfied:&lt;/p&gt;

&lt;p&gt;Airflowç°åœ¨æ”¯æŒçš„Trigger Rules:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ALL_SUCCESS = â€˜all_successâ€™
ALL_FAILED = â€˜all_failedâ€™ 
ALL_DONE = â€˜all_doneâ€™ 
ONE_SUCCESS = â€˜one_successâ€™ 
ONE_FAILED = â€˜one_failedâ€™ 
NONE_FAILED = â€˜none_failedâ€™ 
NONE_SKIPPED = â€˜none_skippedâ€™ 
DUMMY = â€˜dummyâ€™&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;é™¤äº†ä¸Šé¢è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨&lt;strong&gt;DummyOperator&lt;/strong&gt;æ¥è¾¾åˆ°æƒ³è¦çš„æ•ˆæœã€‚ä¹Ÿå°±æ˜¯åœ¨&lt;code class=&quot;highlighter-rouge&quot;&gt;watch_animation&lt;/code&gt;å¹³è¡Œçš„åˆ†æ”¯ä¸ŠåŠ ä¸€ä¸ª&lt;code class=&quot;highlighter-rouge&quot;&gt;dummy&lt;/code&gt;taskï¼Œå®ƒå•¥æ´»éƒ½ä¸å¹²ï¼š&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;n&quot;&gt;dummp_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DummyOperator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;task_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;dummy&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dag&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;do_homework_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;check_hour_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;watch_animation_op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dummp_op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;watch_animation_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sleep_op&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dummp_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sleep_op&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿™ç§æ–¹å¼æ›´ç®€å•æ˜“æ‡‚ï¼Œä»£ä»·å°±æ˜¯ä¼šç¨ç¨å¢åŠ äº›ä»£ç ï¼Œå–œæ¬¢å“ªä¸ªå°±ä»è€…è§ä»äº†:smirk:ã€‚&lt;/p&gt;</content><author><name>jessychen</name></author><category term="Airflow" /><category term="CS" /><summary type="html">Airflow æ˜¯ Airbnb å…¬å¸å¼€æºçš„ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ, é€šè¿‡ä½¿ç”¨ Python å¼€å‘ DAG, éå¸¸æ–¹ä¾¿çš„è°ƒåº¦è®¡ç®—ä»»åŠ¡ã€‚</summary></entry></feed>