var urlPrefix="https://service-90gt32ps-1301650411.gz.apigw.tencentcs.com/";function getQ(){var a=[];$("input[name='op_type']:checked").each(function(b){a[b]=$(this).val()});url=urlPrefix+"calculator";data={"op_count":$(" input[ name='op_count' ] ").val(),"op_type":a.join(","),"limit":$(" input[ name='limit' ] ").val(),"total":$(" input[ name='total' ] ").val()};sendReq(url,data,setResQ)}function setResQ(a){q=a.questions.join("<br />");$("#res").html("<b>"+a.msg+"</b><br />"+q)}function getP(){var c=$(" select[ name='type' ] ").val();var a=parseIndex();indexObj={};var b=$(" input[ name='title' ] ").val();var e=$(" input[ name='author' ] ").val();var d=$(" input[ name='content' ] ").val();if(b){indexObj[a["title"][0]]=b}if(c!="shijing"&&e){indexObj["author"]=e}if(d){indexObj[a["content"]]=d}url=urlPrefix+"poem";data={"type":c,"count":$(" input[ name='count' ] ").val()};data["index"]=indexObj;sendReq(url,data,setResP)}function parseIndex(){var d=["title"];var c="paragraphs";var b=$(" select[ name='type' ] ").val();if(b=="song"){d=["rhythmic"]}if(b=="shijing"){d=["title","chapter","section"];c="content"}var a=[];a["title"]=d;a["content"]=c;return a}function setResP(b){var a=parseIndex();htmls=[];$.each(b.plist,function(f,d){var e=[];$.each(a["title"],function(h,g){e[h]=d[g]});var c="<b>"+e.join(" - ")+"</b>";c=c+"<br />作者："+d["author"];c=c+"<br />"+d[a["content"]].join("<br />");htmls[f]=c});$("#res").html(htmls.join("<hr>"))}function sendReq(b,c,a){$.ajax({url:b,type:"POST",data:JSON.stringify(c),dataType:"json",crossDomain:true,headers:getHeader(),success:function(d){if(d.errorCode<0){$("#res").html("<span style='color:red'>"+d.errorMessage+"</span>");return}a(d)},error:function(d,f,e){$("#res").html("<span style='color:red'>"+d.readyState+";"+d.status+";"+d.responseText+"</span>")}})}function getHeader(){var h=new Date();var i=h.toGMTString();var f="AKID1GU1f51987YhIW0Qxdi85dYbgk2J0pvtHWMX";var d="2bXpeAYfOa6r1f9H3LP1jl326jfPGYiTB8A5neph";var a="kiwi_129014";a="source";var c='hmac id="'+f+'", algorithm="hmac-sha1", headers="x-date source", signature="';var g="x-date: "+i+"\n"+"source: "+a;var b=CryptoJS.HmacSHA1(g,d);b=CryptoJS.enc.Base64.stringify(b);b=c+b+'"';var e={"Source":a,"X-Date":i,"Authorization":b,"Content-Type":"application/json; charset=UTF-8"};return e}function doPrintCal(){content=$("#res").html();var a=window.open("","oPop");a.document.write(content);a.print();a.close()};